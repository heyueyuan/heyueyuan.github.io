<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SQL 教程 | Mark He</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.9854472c.css" as="style"><link rel="preload" href="/assets/js/app.265cfc62.js" as="script"><link rel="preload" href="/assets/js/28.e5f55e62.js" as="script"><link rel="prefetch" href="/assets/js/10.aeb08d6d.js"><link rel="prefetch" href="/assets/js/11.c47163b6.js"><link rel="prefetch" href="/assets/js/12.915cb852.js"><link rel="prefetch" href="/assets/js/13.eff9359d.js"><link rel="prefetch" href="/assets/js/14.a7c6041b.js"><link rel="prefetch" href="/assets/js/15.d636104a.js"><link rel="prefetch" href="/assets/js/16.5692cdd2.js"><link rel="prefetch" href="/assets/js/17.69126d01.js"><link rel="prefetch" href="/assets/js/18.6eeb36a9.js"><link rel="prefetch" href="/assets/js/19.58fca24d.js"><link rel="prefetch" href="/assets/js/2.6ce74938.js"><link rel="prefetch" href="/assets/js/20.25d4abb7.js"><link rel="prefetch" href="/assets/js/21.60fbe128.js"><link rel="prefetch" href="/assets/js/22.1c918ce7.js"><link rel="prefetch" href="/assets/js/23.67e27de0.js"><link rel="prefetch" href="/assets/js/24.22e1499d.js"><link rel="prefetch" href="/assets/js/25.02c31893.js"><link rel="prefetch" href="/assets/js/26.ec379253.js"><link rel="prefetch" href="/assets/js/27.df1dfb7c.js"><link rel="prefetch" href="/assets/js/29.4ab53bc8.js"><link rel="prefetch" href="/assets/js/3.89d1e693.js"><link rel="prefetch" href="/assets/js/30.13a47086.js"><link rel="prefetch" href="/assets/js/31.3e08bbf0.js"><link rel="prefetch" href="/assets/js/32.49e8d2f1.js"><link rel="prefetch" href="/assets/js/33.34b0a6b7.js"><link rel="prefetch" href="/assets/js/34.6c1ac4bc.js"><link rel="prefetch" href="/assets/js/35.521abc2d.js"><link rel="prefetch" href="/assets/js/36.c1ba9b6b.js"><link rel="prefetch" href="/assets/js/37.1b798d69.js"><link rel="prefetch" href="/assets/js/38.9409643a.js"><link rel="prefetch" href="/assets/js/39.8178cfd3.js"><link rel="prefetch" href="/assets/js/4.93bfe19f.js"><link rel="prefetch" href="/assets/js/40.72bda93a.js"><link rel="prefetch" href="/assets/js/41.0a2d9067.js"><link rel="prefetch" href="/assets/js/42.1e3cfe94.js"><link rel="prefetch" href="/assets/js/43.2a8a6955.js"><link rel="prefetch" href="/assets/js/44.f0df4491.js"><link rel="prefetch" href="/assets/js/45.0ec4ef64.js"><link rel="prefetch" href="/assets/js/46.d8ab0cfb.js"><link rel="prefetch" href="/assets/js/47.101b564b.js"><link rel="prefetch" href="/assets/js/48.10290b31.js"><link rel="prefetch" href="/assets/js/49.6f0c6b8b.js"><link rel="prefetch" href="/assets/js/5.7c652252.js"><link rel="prefetch" href="/assets/js/50.48ff2154.js"><link rel="prefetch" href="/assets/js/51.8c372db5.js"><link rel="prefetch" href="/assets/js/52.1188b68c.js"><link rel="prefetch" href="/assets/js/53.a04fdb75.js"><link rel="prefetch" href="/assets/js/54.66b64b21.js"><link rel="prefetch" href="/assets/js/55.923fa6e5.js"><link rel="prefetch" href="/assets/js/56.f51a4e44.js"><link rel="prefetch" href="/assets/js/57.ee90ffbd.js"><link rel="prefetch" href="/assets/js/58.a0fb6737.js"><link rel="prefetch" href="/assets/js/59.5581418f.js"><link rel="prefetch" href="/assets/js/6.397be193.js"><link rel="prefetch" href="/assets/js/60.cba6de65.js"><link rel="prefetch" href="/assets/js/61.6046c511.js"><link rel="prefetch" href="/assets/js/62.9dce1a90.js"><link rel="prefetch" href="/assets/js/63.d8a483b0.js"><link rel="prefetch" href="/assets/js/7.f883906b.js"><link rel="prefetch" href="/assets/js/8.e9363c12.js"><link rel="prefetch" href="/assets/js/9.e10c76be.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9854472c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Mark He</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/articles/datascience/" class="nav-link router-link-active">Data Science</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Development</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Full-Stack</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/articles/development/python/" class="nav-link">Python</a></li><li class="dropdown-subitem"><a href="/articles/development/java/" class="nav-link">Java</a></li><li class="dropdown-subitem"><a href="/articles/development/vue/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/articles/development/Git/" class="nav-link">Git</a></li><li class="dropdown-subitem"><a href="/articles/development/tool/" class="nav-link">Tools</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/articles/algorithm/" class="nav-link">Algorithm</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Network</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/articles/network/R_S/" class="nav-link">Router&amp;Switch</a></li><li class="dropdown-item"><!----> <a href="/articles/network/malfunction/" class="nav-link">Malfunction</a></li></ul></div></div><div class="nav-item"><a href="/articles/speech/" class="nav-link">Speech</a></div><div class="nav-item"><a href="/articles/goals.html" class="nav-link">Goals</a></div><div class="nav-item"><a href="/articles/prepforjob.html" class="nav-link">PrepForJobs</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/articles/datascience/" class="nav-link router-link-active">Data Science</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Development</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Full-Stack</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/articles/development/python/" class="nav-link">Python</a></li><li class="dropdown-subitem"><a href="/articles/development/java/" class="nav-link">Java</a></li><li class="dropdown-subitem"><a href="/articles/development/vue/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/articles/development/Git/" class="nav-link">Git</a></li><li class="dropdown-subitem"><a href="/articles/development/tool/" class="nav-link">Tools</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/articles/algorithm/" class="nav-link">Algorithm</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Network</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/articles/network/R_S/" class="nav-link">Router&amp;Switch</a></li><li class="dropdown-item"><!----> <a href="/articles/network/malfunction/" class="nav-link">Malfunction</a></li></ul></div></div><div class="nav-item"><a href="/articles/speech/" class="nav-link">Speech</a></div><div class="nav-item"><a href="/articles/goals.html" class="nav-link">Goals</a></div><div class="nav-item"><a href="/articles/prepforjob.html" class="nav-link">PrepForJobs</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Data Science</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deep Learning</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Machine Learning</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Big-Data</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>SQL</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/articles/datascience/SQL.html" class="active sidebar-link">SQL 教程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/articles/datascience/SQL.html#sql-基础教程" class="sidebar-link">SQL 基础教程</a></li><li class="sidebar-sub-header"><a href="/articles/datascience/SQL.html#sql-高级教程" class="sidebar-link">SQL 高级教程</a></li><li class="sidebar-sub-header"><a href="/articles/datascience/SQL.html#sql-函数" class="sidebar-link">SQL 函数</a></li><li class="sidebar-sub-header"><a href="/articles/datascience/SQL.html#拓展" class="sidebar-link">拓展</a></li><li class="sidebar-sub-header"><a href="/articles/datascience/SQL.html#oracle-2" class="sidebar-link">Oracle</a></li><li class="sidebar-sub-header"><a href="/articles/datascience/SQL.html#mysql-2" class="sidebar-link">Mysql</a></li><li class="sidebar-sub-header"><a href="/articles/datascience/SQL.html#sql-server" class="sidebar-link">SQL Server</a></li><li class="sidebar-sub-header"><a href="/articles/datascience/SQL.html#redis" class="sidebar-link">Redis</a></li><li class="sidebar-sub-header"><a href="/articles/datascience/SQL.html#mongodb" class="sidebar-link">MongoDB</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Data Warehouse</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>R</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Resource</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="sql-教程">SQL 教程</h1> <h2 id="sql-基础教程">SQL 基础教程</h2> <h3 id="sql简介">SQL简介</h3> <hr> <p>​    SQL（结构化查询语言）是用于访问和操作数据库中的数据的标准数据库编程语言。</p> <p>​    SQL是关系数据库系统的标准语言。所有关系数据库管理系统(RDMS)，如MySQL、MS Access、Oracle、Sybase、Informix、Postgres和SQL Server都使用SQL作为它们的标准数据库语言。</p> <p>​    为了处理数据库和数据库相关的编程，程序员需要有一些介质，或者可以说接口来详细说明一组命令或代码来处理数据库或访问数据库的数据。在本章中，将简要介绍在学习SQL的过程中您将学习的术语。</p> <h3 id="你会从sql中学到什么？">你会从SQL中学到什么？</h3> <hr> <p>​    SQL为结构化查询语言提供了独特的学习和数据库处理技术，并将帮助您更好地控制SQL查询并有效处理这些代码。由于SQL帮助您包括数据库创建，数据库或表删除，获取行数据和修改这些数据等，并行SQL使得事情自动和平滑，最终用户可以轻松访问和处理该应用程序的数据。</p> <h3 id="sql-是什么？">SQL 是什么？</h3> <hr> <ul><li>SQL 发音为“sequel”。</li> <li>SQL 指结构化查询语言，全称是 Structured Query Language（是最初由IBM开发）。</li> <li>SQL 是关系数据库系统的标准语言。</li> <li>SQL 是一种 ANSI（American National Standards Institute 美国国家标准化组织）标准的计算机语言。</li></ul> <h3 id="sql-能做什么？">SQL 能做什么？</h3> <hr> <ul><li><p>SQL可以创建新的数据库及其对象（表，索引，视图，存储过程，函数和触发器）。</p></li> <li><p>SQL可以修改现有数据库的结构。</p></li> <li><p>SQL可以从数据库中删除（删除）对象。</p></li> <li><p>SQL可以TRUNCATE（删除）表中的所有记录。</p></li> <li><p>SQL可以对数据字典进行COMMENT。</p></li> <li><p>SQL可以RENAME一个对象。</p></li> <li><p>SQL可以从数据库中选择（检索）数据。</p></li> <li><p>SQL可以将数据插入到表中。</p></li> <li><p>SQL可以更新表中的现有数据。</p></li> <li><p>SQL可以从数据库表中删除记录。</p></li> <li><p>SQL可以在数据库中设置用户的GRANT和REVOKE权限。</p> <h3 id="sql标准命令">SQL标准命令</h3> <hr> <p>​    与关系数据库交互的标准SQL命令是创建、选择、插入、更新、删除和删除，简单分为以下几组：</p> <h4 id="ddl（数据定义语言）">DDL（数据定义语言）</h4> <p>​    数据定义语言用于改变数据库结构，包括创建、更改和删除数据库对象。用于操纵表结构的数据定义语言命令有：</p> <ul><li><code>CREATE TABLE</code>-- 创建（在数据库中创建新表、表视图或其他对象）</li> <li><code>ALTER TABLE</code>-- 更改 （修改现有的数据库对象，如表）</li> <li><code>DROP TABLE</code>-- 删除  （删除数据库中的整个表、表或其他对象的视图）</li></ul> <h4 id="dml（数据操纵语言）">DML（数据操纵语言）</h4> <p>​    数据操纵语言用于检索、插入和修改数据，数据操纵语言是最常见的SQL命令。</p> <p>​    数据操纵语言命令包括：</p> <ul><li><code>INSERT</code>-- 插入 （创建记录）</li> <li><code>DELETE</code>-- 删除 （删除记录）</li> <li><code>UPDATE</code>-- 修改（修改记录）</li> <li><code>SELECT</code> -- 检索 （从一个或多个表检索某些记录）</li></ul> <h4 id="dcl（数据控制语言）">DCL（数据控制语言）</h4> <p>​    数据控制语言为用户提供权限控制命令。</p> <p>​    用于权限控制的命令有：</p> <ul><li><code>GRANT</code>-- 授予权限</li> <li><code>REVOKE</code>-- 撤销已授予的权限</li></ul> <p><a href="https://www,w3cschool.cn/sql" target="_blank" rel="noopener noreferrer">更多<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <hr></li></ul> <h2 id="sql-高级教程">SQL 高级教程</h2> <h3 id="sql-select-top-limit-rownum">SQL SELECT TOP, LIMIT, ROWNUM</h3> <hr> <ul><li>SELECT TOP 子句用于指定要返回的记录数量。</li> <li>SELECT TOP子句在包含数千条记录的大型表上很有用。返回大量记录会影响性能。</li></ul> <blockquote><p>**注：**并不是所有的数据库系统都支持SELECT TOP子句。MySQL支持LIMIT子句来选择有限数量的记录，而Oracle使用ROWNUM。</p></blockquote> <h5 id="sql-server-ms-access-语法">SQL Server / MS Access 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> number<span class="token operator">|</span><span class="token keyword">percent</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>
</code></pre></div><h5 id="mysql语法："><strong>MySQL语法：</strong></h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition
<span class="token keyword">LIMIT</span> number<span class="token punctuation">;</span>
</code></pre></div><h6 id="实例">实例</h6> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> Persons
<span class="token keyword">LIMIT</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="oracle-语法">Oracle 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> ROWNUM <span class="token operator">&lt;=</span> number<span class="token punctuation">;</span>
</code></pre></div><h6 id="实例-2">实例</h6> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> Persons
<span class="token keyword">WHERE</span> ROWNUM <span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>
</code></pre></div><h3 id></h3> <h3 id="sql-like-运算符">SQL LIKE 运算符</h3> <hr> <p>在WHERE子句中使用LIKE运算符来搜索列中的指定模式。</p> <p>有两个通配符与LIKE运算符一起使用：</p> <ul><li><code>％</code> - 百分号表示零个，一个或多个字符</li> <li><code>_</code> - 下划线表示单个字符</li></ul> <p><strong>注意：</strong> MS Access使用问号（<code>?</code>）而不是下划线（<code>_</code>）。</p> <p>百分号和下划线也可以组合使用！</p> <h5 id="sql-like-语法">SQL LIKE 语法</h5> <div class="language- extra-class"><pre class="language-text"><code>SELECT column1, column2, ...
FROM table_name
WHERE columnN LIKE pattern;
</code></pre></div><p><strong>提示</strong>：您还可以使用AND或OR运算符组合任意数量的条件。</p> <table><thead><tr><th>LIKE 运算符</th> <th>描述</th></tr></thead> <tbody><tr><td>WHERE CustomerName LIKE 'a%'</td> <td>查找以“a”开头的任何值</td></tr> <tr><td>WHERE CustomerName LIKE '%a'</td> <td>查找以“a”结尾的任何值</td></tr> <tr><td>WHERE CustomerName LIKE '%or%'</td> <td>在任何位置查找任何具有“or”的值</td></tr> <tr><td>WHERE CustomerName LIKE '_r%'</td> <td>在第二个位置查找任何具有“r”的值</td></tr> <tr><td>WHERE CustomerName LIKE 'a_%_%'</td> <td>查找以“a”开头且长度至少为3个字符的值</td></tr> <tr><td>WHERE ContactName LIKE 'a%o'</td> <td>找到以&quot;a&quot;开头，以&quot;o&quot;结尾的值</td></tr></tbody></table> <h3 id="sql-in-运算符">SQL IN 运算符</h3> <hr> <p>IN运算符允许您在WHERE子句中指定多个值。</p> <p>IN运算符是多个OR条件的简写。</p> <h5 id="sql-in-语法">SQL IN 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> column_name <span class="token operator">IN</span> <span class="token punctuation">(</span>value1<span class="token punctuation">,</span> value2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="或者">或者</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> column_name <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> STATEMENT<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-between-运算符">SQL BETWEEN 运算符</h3> <hr> <p>BETWEEN运算符用于选取介于两个值之间的数据范围内的值。</p> <p>BETWEEN运算符选择给定范围内的值。值可以是数字，文本或日期。</p> <p>BETWEEN运算符是包含性的：包括开始和结束值，且开始值需小于结束值。</p> <h5 id="sql-between-语法">SQL BETWEEN 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> column_name <span class="token operator">BETWEEN</span> value1 <span class="token operator">AND</span> value2<span class="token punctuation">;</span>
</code></pre></div><p>要否定BETWEEN运算符的结果，可以添加NOT运算符：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> column_name <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> value1 <span class="token operator">AND</span> value2<span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-数据类型快速参考手册">SQL 数据类型快速参考手册</h3> <hr> <p>然而，不同的数据库为数据类型定义提供了不同的选择。
　下表显示了不同数据库平台上某些数据类型的通用名称：</p> <table><thead><tr><th style="text-align:left">数据类型</th> <th style="text-align:left">Access</th> <th style="text-align:left">SQLServer</th> <th style="text-align:left">Oracle</th> <th style="text-align:left">MySQL</th> <th style="text-align:left">PostgreSQL</th></tr></thead> <tbody><tr><td style="text-align:left"><em>boolean</em></td> <td style="text-align:left">Yes/No</td> <td style="text-align:left">Bit</td> <td style="text-align:left">Byte</td> <td style="text-align:left">N/A</td> <td style="text-align:left">Boolean</td></tr> <tr><td style="text-align:left"><em>integer</em></td> <td style="text-align:left">Number (integer)</td> <td style="text-align:left">Int</td> <td style="text-align:left">Number</td> <td style="text-align:left">Int  Integer</td> <td style="text-align:left">Int  Integer</td></tr> <tr><td style="text-align:left"><em>float</em></td> <td style="text-align:left">Number (single)</td> <td style="text-align:left">Float  Real</td> <td style="text-align:left">Number</td> <td style="text-align:left">Float</td> <td style="text-align:left">Numeric</td></tr> <tr><td style="text-align:left"><em>currency</em></td> <td style="text-align:left">Currency</td> <td style="text-align:left">Money</td> <td style="text-align:left">N/A</td> <td style="text-align:left">N/A</td> <td style="text-align:left">Money</td></tr> <tr><td style="text-align:left"><em>string (fixed)</em></td> <td style="text-align:left">N/A</td> <td style="text-align:left">Char</td> <td style="text-align:left">Char</td> <td style="text-align:left">Char</td> <td style="text-align:left">Char</td></tr> <tr><td style="text-align:left"><em>string (variable)</em></td> <td style="text-align:left">Text (&lt;256)  Memo (65k+)</td> <td style="text-align:left">Varchar</td> <td style="text-align:left">Varchar  Varchar2</td> <td style="text-align:left">Varchar</td> <td style="text-align:left">Varchar</td></tr> <tr><td style="text-align:left"><em>binary object</em></td> <td style="text-align:left">OLE Object Memo</td> <td style="text-align:left">Binary (fixed up to 8K)  Varbinary (&lt;8K)  Image (&lt;2GB)</td> <td style="text-align:left">Long  Raw</td> <td style="text-align:left">Blob  Text</td> <td style="text-align:left">Binary  Varbinary</td></tr></tbody></table> <h3 id="sql-连接（joins）">SQL 连接（Joins）</h3> <hr> <p>SQL JOIN 子句用于把来自两个或多个表的行结合起来，基于这些表之间的共同字段。</p> <p>简单地说，就是先确定一个主表作为结果集，然后，把其他表的行有选择性地“连接”在主表结果集上。</p> <p>最常见的 JOIN 类型：<strong>SQL INNER JOIN（简单的 JOIN）</strong>。 SQL INNER JOIN 从多个表中返回满足 JOIN 条件的所有行。</p> <p>让我们看看选自 &quot;Orders&quot; 表的数据：</p> <table><thead><tr><th style="text-align:left">OrderID</th> <th style="text-align:left">CustomerID</th> <th style="text-align:left">OrderDate</th></tr></thead> <tbody><tr><td style="text-align:left">10308</td> <td style="text-align:left">2</td> <td style="text-align:left">1996-09-18</td></tr> <tr><td style="text-align:left">10309</td> <td style="text-align:left">37</td> <td style="text-align:left">1996-09-19</td></tr> <tr><td style="text-align:left">10310</td> <td style="text-align:left">77</td> <td style="text-align:left">1996-09-20</td></tr></tbody></table> <p>然后，看看选自 &quot;Customers&quot; 表的数据：</p> <table><thead><tr><th style="text-align:left">CustomerID</th> <th style="text-align:left">CustomerName</th> <th style="text-align:left">ContactName</th> <th style="text-align:left">Country</th></tr></thead> <tbody><tr><td style="text-align:left">1</td> <td style="text-align:left">Alfreds Futterkiste</td> <td style="text-align:left">Maria Anders</td> <td style="text-align:left">Germany</td></tr> <tr><td style="text-align:left">2</td> <td style="text-align:left">Ana Trujillo Emparedados y helados</td> <td style="text-align:left">Ana Trujillo</td> <td style="text-align:left">Mexico</td></tr> <tr><td style="text-align:left">3</td> <td style="text-align:left">Antonio Moreno Taquería</td> <td style="text-align:left">Antonio Moreno</td> <td style="text-align:left">Mexico</td></tr></tbody></table> <p>请注意，&quot;Orders&quot; 表中的 &quot;CustomerID&quot; 列指向 &quot;Customers&quot; 表中的客户。上面这两个表是通过 &quot;CustomerID&quot; 列联系起来的。</p> <p>然后，如果我们运行下面的 SQL 语句（包含 INNER JOIN）：</p> <h3 id="实例-3">实例</h3> <p>SELECT Orders.OrderID, Customers.CustomerName, Orders.OrderDate
FROM Orders
INNER JOIN Customers
ON Orders.CustomerID=Customers.CustomerID;</p> <p>运行结果如下所示：</p> <table><thead><tr><th style="text-align:left">OrderID</th> <th style="text-align:left">CustomerName</th> <th style="text-align:left">OrderDate</th></tr></thead> <tbody><tr><td style="text-align:left">10308</td> <td style="text-align:left">Ana Trujillo Emparedados y helados</td> <td style="text-align:left">1996-09-18</td></tr></tbody></table> <p>值得注意的是，连接是在WHERE子句中执行的。</p> <p>可以使用几个操作符连接表，例如=、&lt;、&gt;、&lt;=、&gt;=、！=、BETWEEN、LIKE、 和NOT。</p> <h5 id="不同的-sql-join">不同的 SQL JOIN</h5> <hr> <p>在我们继续讲解实例之前，我们先列出您可以使用的不同的 SQL JOIN 类型：</p> <ul><li><strong>INNER JOIN</strong>：如果表中有至少一个匹配，则返回行</li> <li><strong>LEFT JOIN</strong>：即使右表中没有匹配，也从左表返回所有的行</li> <li><strong>RIGHT JOIN</strong>：即使左表中没有匹配，也从右表返回所有的行</li> <li><strong>FULL JOIN</strong>：只要其中一个表中存在匹配，则返回行</li> <li><strong>SELF JOIN</strong>：用于将表连接到自己，就好像该表是两个表一样，临时重命名了SQL语句中的至少一个表</li> <li><strong>CARTESIAN JOIN</strong>：从两个或多个连接表返回记录集的笛卡儿积</li></ul> <h6 id="sql-inner-join-关键字（内部连接）">SQL INNER JOIN 关键字（内部连接）</h6> <hr> <p>内部链接INNER JOIN关键字选择两个表中具有匹配值的记录。</p> <p>######## SQL INNER JOIN 语法</p> <div class="language- extra-class"><pre class="language-text"><code>SELECT column_name(s)
FROM table1
INNER JOIN table2 ON table1.column_name = table2.column_name;
</code></pre></div><p>**注释：**INNER JOIN 与 JOIN 是相同的。</p> <p><img src="https://atts.w3cschool.cn/attachments/day_160815/201608151946162952.gif" alt="SQL INNER JOIN"></p> <p>######## 加入三张表</p> <hr> <p>以下SQL语句选择包含客户和货运单信息的所有订单：</p> <p><strong>代码示例：</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Orders<span class="token punctuation">.</span>OrderID<span class="token punctuation">,</span> Customers<span class="token punctuation">.</span>CustomerName<span class="token punctuation">,</span> Shippers<span class="token punctuation">.</span>ShipperName
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Orders
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Customers <span class="token keyword">ON</span> Orders<span class="token punctuation">.</span>CustomerID <span class="token operator">=</span> Customers<span class="token punctuation">.</span>CustomerID<span class="token punctuation">)</span>
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Shippers <span class="token keyword">ON</span> Orders<span class="token punctuation">.</span>ShipperID <span class="token operator">=</span> Shippers<span class="token punctuation">.</span>ShipperID<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h6 id="sql-左连接-left-join-关键字">SQL 左连接 LEFT JOIN 关键字</h6> <hr> <p>SQL左链接LEFT JOIN关键字返回左表（表1）中的所有行，即使在右表（表2）中没有匹配。如果在正确的表中没有匹配，结果是NULL。</p> <p>######## SQL LEFT JOIN 语法</p> <div class="language- extra-class"><pre class="language-text"><code>SELECT column_name(s)                
FROM table1                
LEFT JOIN table2                
ON table1.column_name=table2.column_name;       
</code></pre></div><p>或：</p> <div class="language- extra-class"><pre class="language-text"><code>SELECT column_name(s)                
FROM table1                
LEFT OUTER JOIN table2                
ON table1.column_name=table2.column_name;      
</code></pre></div><blockquote><p>**注释：**在一些数据库中，LEFT JOIN称为LEFT OUT ER JOIN。</p></blockquote> <p><img src="https://atts.w3cschool.cn/attachments/day_160815/201608151944346042.gif" alt="SQL LEFT JOIN"></p> <h6 id="sql右连接-right-join-关键字">SQL右连接 RIGHT JOIN 关键字</h6> <hr> <p>SQL右链接 RIGHT JOIN 关键字返回右表（table2）的所有行，即使在左表（table1）上没有匹配。如果左表没有匹配，则结果为NULL。</p> <p>######## SQL RIGHT JOIN 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table1
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> table2 <span class="token keyword">ON</span> table1<span class="token punctuation">.</span>column_name <span class="token operator">=</span> table2<span class="token punctuation">.</span>column_name<span class="token punctuation">;</span>
</code></pre></div><blockquote><p>**注释：**在一些数据库中，RIGHT JOIN 称为 RIGHT OUTER JOIN。</p></blockquote> <p><img src="https://atts.w3cschool.cn/attachments/day_160815/201608151944076968.gif" alt="SQL RIGHT JOIN"></p> <p>######SQL FULL OUTER JOIN 关键字</p> <hr> <p>当左（表1）或右（表2）表记录匹配时，FULL OUTER JOIN关键字将返回所有记录。</p> <p><strong>注意：</strong> FULL OUTER JOIN可能会返回非常大的结果集！</p> <p>########SQL FULL OUTER JOIN 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table1
<span class="token keyword">FULL</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> table2 <span class="token keyword">ON</span> table1<span class="token punctuation">.</span>column_name <span class="token operator">=</span> table2<span class="token punctuation">.</span>column_name<span class="token punctuation">;</span>
</code></pre></div><p>​										<img src="https://atts.w3cschool.cn/attachments/day_160815/201608151947092720.gif" alt="SQL FULL OUTER JOIN"></p> <p>######SQL自连接</p> <hr> <p>自联接是一种常规联接，但表本身是连接的。</p> <p>########Self JOIN语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table1 T1<span class="token punctuation">,</span> table1 T2
<span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>
</code></pre></div><p>演示数据库</p> <hr> <p>在本教程中，我们将使用着名的Northwind示例数据库。</p> <p>以下是&quot;Customers&quot;表中的选择：</p> <table><thead><tr><th>CustomerID</th> <th>CustomerName</th> <th>ContactName</th> <th>Address</th> <th>City</th> <th>PostalCode</th> <th>Country</th></tr></thead> <tbody><tr><td>1</td> <td>Alfreds Futterkiste</td> <td>Maria Anders</td> <td>Obere Str. 57</td> <td>Berlin</td> <td>12209</td> <td>Germany</td></tr> <tr><td>2</td> <td>Ana Trujillo Emparedados y helados</td> <td>Ana Trujillo</td> <td>Avda. de la Constitución 2222</td> <td>México D.F.</td> <td>05021</td> <td>Mexico</td></tr> <tr><td>3</td> <td>Antonio Moreno Taquería</td> <td>Antonio Moreno</td> <td>Mataderos 2312</td> <td>México D.F.</td> <td>05023</td> <td>Mexico</td></tr></tbody></table> <p>######## SQL Self JOIN示例</p> <hr> <p>以下SQL语句匹配来自同一城市的客户：</p> <p>######### 代码示例</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> A<span class="token punctuation">.</span>CustomerName <span class="token keyword">AS</span> CustomerName1<span class="token punctuation">,</span> B<span class="token punctuation">.</span>CustomerName <span class="token keyword">AS</span> CustomerName2<span class="token punctuation">,</span> A<span class="token punctuation">.</span>City
<span class="token keyword">FROM</span> Customers A<span class="token punctuation">,</span> Customers B
<span class="token keyword">WHERE</span> A<span class="token punctuation">.</span>CustomerID <span class="token operator">&lt;&gt;</span> B<span class="token punctuation">.</span>CustomerID
<span class="token operator">AND</span> A<span class="token punctuation">.</span>City <span class="token operator">=</span> B<span class="token punctuation">.</span>City 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> A<span class="token punctuation">.</span>City<span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-union-运算符">SQL UNION 运算符</h3> <hr> <p>UNION运算符用于组合两个或更多SELECT语句的结果集，而不返回任何重复的行。</p> <ul><li>UNION中的每个SELECT语句必须具有相同的列数</li> <li>这些列也必须具有相似的数据类型</li> <li>每个SELECT语句中的列也必须以相同的顺序排列</li> <li>每个SELECT语句必须有相同数目的列表达式</li> <li>但是每个SELECT语句的长度不必相同</li></ul> <h5 id="sql-union-语法1">SQL UNION 语法1</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table1
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table2<span class="token punctuation">;</span>
</code></pre></div><blockquote><p>**注释：**默认情况下，UNION 运算符选择一个不同的值。如果允许重复值，请使用 UNION ALL。</p></blockquote> <h5 id="sql-union-语法2">SQL UNION 语法2</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table1
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> condition<span class="token punctuation">]</span>

<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table2
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> condition<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>给定的条件可以是基于您的需求的任何给定表达式。</p> <h5 id="sql-union-all-语法1">SQL UNION ALL 语法1</h5> <p>UNION All运算符用于组合两个SELECT语句(包括重复行)的结果。</p> <p>适用于UNION子句的相同规则将适用于UNION All操作符。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table1
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table2<span class="token punctuation">;</span>
</code></pre></div><blockquote><p>**注释：**UNION结果集中的列名总是等于UNION中第一个SELECT语句中的列名。</p></blockquote> <h5 id="sql-union-all-语法2">SQL UNION ALL 语法2</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table1
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> condition<span class="token punctuation">]</span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table2
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> condition<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-select-into-语句">SQL SELECT INTO 语句</h3> <hr> <p>使用 SQL，您可以将信息从一个表中复制到另一个表中。</p> <p>SELECT INTO 语句从一个表中复制数据，然后将数据插入到另一个新表中。</p> <h5 id="sql-select-into-语法">SQL SELECT INTO 语法</h5> <p>我们可以把所有的列都复制到新表中：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">INTO</span> newtable <span class="token punctuation">[</span><span class="token operator">IN</span> externaldb<span class="token punctuation">]</span>
<span class="token keyword">FROM</span> table1<span class="token punctuation">;</span>
</code></pre></div><p>或者只复制希望的列插入到新表中：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">INTO</span> newtable <span class="token punctuation">[</span><span class="token operator">IN</span> externaldb<span class="token punctuation">]</span>
<span class="token keyword">FROM</span> table1<span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-insert-into-select-语句">SQL INSERT INTO SELECT 语句</h3> <hr> <p>使用SQL，您可以将信息从一个表中复制到另一个表中。</p> <p>INSERT INTO SELECT 语句从表中复制数据，并将数据插入现有的表中。目标表中的任何现有行都不会受到影响。</p> <h5 id="sql-insert-into-select-语法">SQL INSERT INTO SELECT 语法</h5> <p>我们可以将所有列从一个表中复制到另一个已经存在的表中：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> table2              
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table1<span class="token punctuation">;</span>    
</code></pre></div><p>或者我们可以把想要的列复制到另一个现有的表中：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> table2               
<span class="token punctuation">(</span>column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>              
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>             
<span class="token keyword">FROM</span> table1<span class="token punctuation">;</span>   
</code></pre></div><blockquote><p>insert into select和select into区别，前者目标表必须存在</p></blockquote> <h3 id="sql-撤销索引、撤销表以及撤销数据库">SQL 撤销索引、撤销表以及撤销数据库</h3> <hr> <p>通过使用 DROP 语句，可以轻松地删除索引、表和数据库。</p> <h3 id="drop-index-语句">DROP INDEX 语句</h3> <hr> <p>DROP INDEX 语句用于删除表中的索引。</p> <h5 id="用于-ms-access-的-drop-index-语法：">用于 MS Access 的 DROP INDEX 语法：</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name      
</code></pre></div><h5 id="用于-ms-sql-server-的-drop-index-语法：">用于 MS SQL Server 的 DROP INDEX 语法：</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> table_name<span class="token punctuation">.</span>index_name     
</code></pre></div><h5 id="用于-db2-oracle-的-drop-index-语法：">用于 DB2/Oracle 的 DROP INDEX 语法：</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name   
</code></pre></div><h5 id="用于-mysql-的-drop-index-语法：">用于 MySQL 的 DROP INDEX 语法：</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name       
</code></pre></div><h3 id="drop-table-语句">DROP TABLE 语句</h3> <hr> <p>DROP TABLE 语句用于删除表。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> table_name      
</code></pre></div><h3 id="drop-database-语句">DROP DATABASE 语句</h3> <hr> <p>DROP DATABASE 语句用于删除数据库。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> database_name    
</code></pre></div><h3 id="truncate-table-语句">TRUNCATE TABLE 语句</h3> <hr> <p>如果我们只需要删除表中的数据，而不删除表本身，那么我们该怎么做？</p> <p>使用TRUNCATE TABLE语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> table_name   
</code></pre></div><h3 id="sql-create-alter语句">SQL CREATE/ALTER语句</h3> <h5 id="sql-create-database-语法">SQL CREATE DATABASE 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> dbname<span class="token punctuation">;</span>
</code></pre></div><h5 id="sql-create-table-语法">SQL CREATE TABLE 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name                
<span class="token punctuation">(</span>                
column_name1 data_type<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>                
column_name2 data_type<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>                
column_name3 data_type<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>                
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                
<span class="token punctuation">)</span><span class="token punctuation">;</span>       
</code></pre></div><h5 id="sql-alter-table-语法">SQL ALTER TABLE 语法</h5> <p>若要向表中添加列，请使用以下语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name                
<span class="token keyword">ADD</span> column_name datatype      
</code></pre></div><p>若要删除表中的列，请使用以下语法（请注意，一些数据库系统不允许这样删除数据库表中的列）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name                
<span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> column_name      
</code></pre></div><p>若要更改表中列的数据类型，请使用以下语法：</p> <p><strong>SQL Server / MS Access：</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name                
<span class="token keyword">ALTER</span> <span class="token keyword">COLUMN</span> column_name datatype       
</code></pre></div><p><strong>My SQL / Oracle：</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name                
<span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> column_name datatype        
</code></pre></div><h3 id="sql-auto-increment-字段">SQL AUTO INCREMENT 字段</h3> <hr> <p>Auto-increment 会在新记录插入表中时生成一个唯一的数字。</p> <h3 id="auto-increment-字段">AUTO INCREMENT 字段</h3> <hr> <p>我们通常希望在每次插入新记录时自动创建主键字段的值。</p> <p>我们可以在表中创建一个自动增量（auto-increment）字段。</p> <h3 id="用于-mysql-的语法">用于 MySQL 的语法</h3> <hr> <p>以下SQL语句将 &quot;Persons&quot; 表中的“ID”列定义为自动递增（auto-increment）主键字段：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons                
<span class="token punctuation">(</span>                
ID <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>                
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>                
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>ID<span class="token punctuation">)</span>                
<span class="token punctuation">)</span>
</code></pre></div><p>MySQL使用AUTO_INREMENT关键字来执行自动增量（ auto-increment ）任务。</p> <p>默认情况下，AUTO_INREMENT的起始值为1，每个新记录增加1。</p> <p>若要以其他值开始AUTO_INREMENT序列，请使用以下SQL语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">100</span>       
</code></pre></div><p>要在 &quot;Persons&quot; 表中插入新记录，我们不需要为&quot;ID&quot;栏指定值（自动添加唯一值）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>FirstName<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span>                
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Lars'</span><span class="token punctuation">,</span><span class="token string">'Monsen'</span><span class="token punctuation">)</span>        
</code></pre></div><p>上面的SQL语句在 &quot;Persons&quot; 表中插入一个新记录。“ID”栏将得到唯一值。&quot;FirstName&quot;栏设置为&quot;Lars&quot;，&quot;LastName&quot;栏设置为&quot;Monsen&quot;。</p> <h3 id="用于-sql-server-的语法">用于 SQL Server 的语法</h3> <hr> <p>以下SQL语句将 &quot;Persons&quot; 表中的“ID”列定义为自动递增（ auto-increment ）主键字段：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons                
<span class="token punctuation">(</span>                
ID <span class="token keyword">int</span> <span class="token keyword">IDENTITY</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>                
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>                
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>                
<span class="token punctuation">)</span>       
</code></pre></div><p>MS SQL Server使用IDENTITY关键字执行自动增量（ auto-increment ）任务。</p> <p>在上面的示例中，IDENTITY的起始值为1，每个新记录增量为1。</p> <p>提示：指定“ID”列以10开头，并递增5，将标识（ identity ）更改为IDENTITY（10,5）。</p> <p>要在 &quot;Persons&quot; 表中插入新记录，我们不需要为&quot;ID&quot;栏指定值（自动添加唯一值）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>FirstName<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span>                
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Lars'</span><span class="token punctuation">,</span><span class="token string">'Monsen'</span><span class="token punctuation">)</span>        
</code></pre></div><p>上面的 SQL 语句在 &quot;Persons&quot; 表中插入一个新记录。“ID”栏将得到唯一值。&quot;FirstName&quot;栏设置为&quot;Lars&quot;，&quot;LastName&quot;栏设置为&quot;Monsen&quot;。</p> <h3 id="用于-access-的语法">用于 Access 的语法</h3> <hr> <p>以下 SQL 语句将 &quot;Persons&quot; 表中的“ID”列定义为自动递增（ auto-increment ）主键字段：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons                
<span class="token punctuation">(</span>                
ID <span class="token keyword">Integer</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> AUTOINCREMENT<span class="token punctuation">,</span>                
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>                
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>                
<span class="token punctuation">)</span>       
</code></pre></div><p>MS Access使用 AUTOINCREMENT 关键字执行自动增量（ auto-increment ）任务。</p> <p>默认情况下，AUTOINCREMEN的起始值为1，每个新记录递增 1。</p> <p>**提示：**指定“ID”栏以10开头，并递增5，将自动递增（ autoincrement ）更改为自动递增（105）（ AUTOINCREMENT(10,5)）。</p> <p>要在 &quot;Persons&quot; 表中插入新记录，我们不需要为&quot;ID&quot;栏指定值（自动添加唯一值）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>FirstName<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span>                
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Lars'</span><span class="token punctuation">,</span><span class="token string">'Monsen'</span><span class="token punctuation">)</span>        
</code></pre></div><p>上面的 SQL 语句在 &quot;Persons&quot; 表中插入一个新记录。“ID”栏将得到唯一值。&quot;FirstName&quot;栏设置为&quot;Lars&quot;，&quot;LastName&quot;栏设置为&quot;Monsen&quot;。</p> <h3 id="语法-for-oracle">语法 for Oracle</h3> <hr> <p>在 Oracle 中，代码有点复杂。</p> <p>您必须使用序列（ sequence ）对象（该对象生成数字序列）创建自动增量（ auto-increment ）字段。</p> <p>使用以下CREATSEQUENT语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> SEQUENCE seq_person                
MINVALUE <span class="token number">1</span>                
<span class="token keyword">START</span> <span class="token keyword">WITH</span> <span class="token number">1</span>                
INCREMENT <span class="token keyword">BY</span> <span class="token number">1</span>                
CACHE <span class="token number">10</span>        
</code></pre></div><p>上面的代码创建了一个名为seq_pean的序列( sequence) 对象，它以1开头，以1递增。此对象缓存10个值以提高性能。缓存选项指定要存储多少序列值以提高访问速度。</p> <p>要在&quot;Persons&quot; 表中插入新记录，我们必须使用nextval函数，该函数从seq_hor序列检索下一个值：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>ID<span class="token punctuation">,</span>FirstName<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span>                
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>seq_person<span class="token punctuation">.</span>nextval<span class="token punctuation">,</span><span class="token string">'Lars'</span><span class="token punctuation">,</span><span class="token string">'Monsen'</span><span class="token punctuation">)</span>       
</code></pre></div><p>上面的SQL语句在 &quot;Persons&quot; 表中插入一个新记录。&quot;ID&quot; 列从 seq_person 序列中分配下一个数字。&quot;FirstName&quot;栏设置为&quot;Lars&quot;，&quot;LastName&quot;栏设置为&quot;Monsen&quot;。</p> <h3 id="sql-视图（views）">SQL 视图（Views）</h3> <hr> <p>视图是可视化的表。</p> <p>本章讲解如何创建、更新和删除视图。</p> <h3 id="sql-create-view-语句">SQL CREATE VIEW 语句</h3> <hr> <p>在 SQL 中，视图是基于 SQL 语句的结果集的可视化表。</p> <p>视图包含行和列，就像真正的表一样。视图中的字段是一个或多个数据库中真实表中的字段。</p> <p>您可以添加 SQL 函数，在哪里添加，并将语句连接到视图，或者您可以呈现数据，就像数据来自单个表一样。</p> <h5 id="sql-create-view-语法">SQL CREATE VIEW 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> view_name <span class="token keyword">AS</span>                
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>                
<span class="token keyword">FROM</span> table_name                
<span class="token keyword">WHERE</span> condition      
</code></pre></div><p>**注释：**视图总是显示最新数据！每当用户查询视图时，数据库引擎就使用视图的 SQL 语句重新构建数据。</p> <h3 id="sql-create-view-实例">SQL CREATE VIEW 实例</h3> <hr> <p>示例数据库 Northwind 默认安装了一些视图。</p> <p>&quot;Current Product List&quot;(当前产品列表)视图从&quot;Products&quot;表中列出了所有正在使用的产品（未停产的产品）。这个视图使用下面的 SQL 创建：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span><span class="token keyword">Current</span> Product List<span class="token punctuation">]</span> <span class="token keyword">AS</span>                
<span class="token keyword">SELECT</span> ProductID<span class="token punctuation">,</span>ProductName                
<span class="token keyword">FROM</span> Products                
<span class="token keyword">WHERE</span> Discontinued<span class="token operator">=</span><span class="token keyword">No</span>      
</code></pre></div><p>我们可以像这样查询上面这个视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span><span class="token keyword">Current</span> Product List<span class="token punctuation">]</span>        
</code></pre></div><p>Northwind 样本数据库的另一个视图会选取 &quot;Products&quot; 表中所有单位价格高于平均单位价格的产品：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span>Products Above Average Price<span class="token punctuation">]</span> <span class="token keyword">AS</span>                
<span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice                
<span class="token keyword">FROM</span> Products                
<span class="token keyword">WHERE</span> UnitPrice<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>UnitPrice<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Products<span class="token punctuation">)</span>     
</code></pre></div><p>我们可以像这样查询上面这个视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>Products Above Average Price<span class="token punctuation">]</span>        
</code></pre></div><p>Northwind 样本数据库的另一个视图会计算在 1997 年每个种类的销售总数。请注意，这个视图会从另一个名为 &quot;Product Sales for 1997&quot; 的视图那里选取数据：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span>Category Sales <span class="token keyword">For</span> <span class="token number">1997</span><span class="token punctuation">]</span> <span class="token keyword">AS</span>                
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> CategoryName<span class="token punctuation">,</span><span class="token function">Sum</span><span class="token punctuation">(</span>ProductSales<span class="token punctuation">)</span> <span class="token keyword">AS</span> CategorySales                
<span class="token keyword">FROM</span> <span class="token punctuation">[</span>Product Sales <span class="token keyword">for</span> <span class="token number">1997</span><span class="token punctuation">]</span>                
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CategoryName       
</code></pre></div><p>我们可以像这样查询上面这个视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>Category Sales <span class="token keyword">For</span> <span class="token number">1997</span><span class="token punctuation">]</span>       
</code></pre></div><p>我们也可以向查询添加条件。现在，我们仅仅需要查看 &quot;Beverages&quot; 类的销售总数：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>Category Sales <span class="token keyword">For</span> <span class="token number">1997</span><span class="token punctuation">]</span>                
<span class="token keyword">WHERE</span> CategoryName<span class="token operator">=</span><span class="token string">'Beverages'</span>        
</code></pre></div><h3 id="sql-更新视图">SQL 更新视图</h3> <hr> <p>您可以使用下面的语法来更新视图：</p> <h5 id="sql-create-or-replace-view-语法">SQL CREATE OR REPLACE VIEW 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> view_name <span class="token keyword">AS</span>                
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>                
<span class="token keyword">FROM</span> table_name                
<span class="token keyword">WHERE</span> condition        
</code></pre></div><p>现在，我们希望向 &quot;Current Product List&quot; 视图添加 &quot;Category&quot; 列。我们将通过下列 SQL 更新视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span><span class="token keyword">Current</span> Product List<span class="token punctuation">]</span> <span class="token keyword">AS</span>                
<span class="token keyword">SELECT</span> ProductID<span class="token punctuation">,</span>ProductName<span class="token punctuation">,</span>Category                
<span class="token keyword">FROM</span> Products                
<span class="token keyword">WHERE</span> Discontinued<span class="token operator">=</span><span class="token keyword">No</span>        
</code></pre></div><h3 id="sql-撤销视图">SQL 撤销视图</h3> <hr> <p>您可以通过 DROP VIEW 命令来删除视图。</p> <h5 id="sql-drop-view-语法">SQL DROP VIEW 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> view_name     
</code></pre></div><h3 id="sql-别名（aliases）">SQL 别名（Aliases）</h3> <hr> <p>通过使用 SQL，可以为表名称或列名称指定别名（Alias）。</p> <ul><li>SQL 别名用于为表或表中的列提供临时名称，数据库中的实际表名不会更改。</li> <li>SQL 别名通常用于使列名更具可读性。</li> <li>SQL 一个别名只存在于查询期间。</li> <li>表别名的使用是在特定SQL语句中重命名表。</li> <li>列别名用于为特定SQL查询重命名表的列。</li></ul> <h5 id="列的-sql-alias-语法">列的 SQL Alias 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name <span class="token keyword">AS</span> alias_name
<span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span>condition<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="表的-sql-alias-语法">表的 SQL Alias 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name <span class="token keyword">AS</span> alias_name<span class="token punctuation">;</span>
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span>condition<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-约束">SQL 约束</h3> <hr> <p>约束是作用于数据表中列上的规则，用于限制表中数据的类型。约束的存在保证了数据库中数据的精确性和可靠性。</p> <p>约束有列级和表级之分，列级约束作用于单一的列，而表级约束作用于整张数据表。</p> <p>下面是 SQL 中常用的约束，这些约束虽然已经在关系型数据库管理系统一章中讨论过了，但是仍然值得在这里回顾一遍。</p> <ul><li><a href="https://www.w3cschool.cn/sql/6tlpzfpb.html" target="_blank" rel="noopener noreferrer">NOT NULL 约束<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：保证列中数据不能有 NULL 值</li> <li><a href="https://www.w3cschool.cn/sql/jm8e9fpj.html" target="_blank" rel="noopener noreferrer">DEFAULT 约束<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：提供该列数据未指定时所采用的默认值</li> <li><a href="https://www.w3cschool.cn/sql/wxzqsfpc.html" target="_blank" rel="noopener noreferrer">UNIQUE 约束<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：保证列中的所有数据各不相同</li> <li><a href="https://www.w3cschool.cn/sql/vle8zfpd.html" target="_blank" rel="noopener noreferrer">主键约束<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：唯一标识数据表中的行/记录</li> <li><a href="https://www.w3cschool.cn/sql/5dycsfpf.html" target="_blank" rel="noopener noreferrer">外键约束<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：唯一标识其他表中的一条行/记录</li> <li><a href="https://www.w3cschool.cn/sql/fsq7hfph.html" target="_blank" rel="noopener noreferrer">CHECK 约束<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：此约束保证列中的所有值满足某一条件</li> <li><a href="https://www.w3cschool.cn/sql/cuj91oz2.html" target="_blank" rel="noopener noreferrer">索引<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：用于在数据库中快速创建或检索数据</li></ul> <p>约束可以在创建表时规定（通过 CREATE TABLE 语句），或者在表创建之后规定（通过 ALTER TABLE 语句）。</p> <h3 id="sql-克隆数据表">SQL 克隆数据表</h3> <hr> <p>有些情况下，你可能需要原样拷贝某张数据表。但是，CREATE TABEL 却不能满足你的需要，因为复制表必须和原表拥有一样的索引、默认值等等。</p> <p>如果你在使用 MySQL 关系型数据库管理系统的话，下面几个步骤可以帮你解决这个问题：</p> <ul><li>使用 SHOW CREATE TABLE 命令来获取一条指定了原表的结构、索引等信息的 CREATE　TABLE 语句。</li> <li>将语句中的表名修改为克隆表的名字，然后执行该语句。这样你就可以得到一张与原表完全相同的克隆表了。</li> <li>如果你还想要复制表中的数据的话，请执行 INSERT INTO ... SELECT 语句。</li></ul> <h3 id="示例：">示例：</h3> <hr> <p>请尝试下面的示例，为 TUTORIALS_TBL 创建一张克隆表，其结构如下所示：</p> <h5 id="步骤一：">步骤一：</h5> <p>获取数据表的完整结构：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> TUTORIALS_TBL \G<span class="token punctuation">;</span>
<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token number">1.</span> <span class="token keyword">row</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
       <span class="token keyword">Table</span>: TUTORIALS_TBL
<span class="token keyword">Create</span> <span class="token keyword">Table</span>: <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>TUTORIALS_TBL<span class="token punctuation">`</span> <span class="token punctuation">(</span>
  <span class="token punctuation">`</span>tutorial_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>tutorial_title<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>tutorial_author<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>submission_date<span class="token punctuation">`</span> <span class="token keyword">date</span> <span class="token keyword">default</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span>  <span class="token punctuation">(</span><span class="token punctuation">`</span>tutorial_id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token punctuation">`</span>AUTHOR_INDEX<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>tutorial_author<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">TYPE</span><span class="token operator">=</span>MyISAM
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h5 id="步骤二：">步骤二：</h5> <p>改变表名，创建新表：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>CLONE_TBL<span class="token punctuation">`</span> <span class="token punctuation">(</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">`</span>tutorial_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">`</span>tutorial_title<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">,</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">`</span>tutorial_author<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">,</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">`</span>submission_date<span class="token punctuation">`</span> <span class="token keyword">date</span> <span class="token keyword">default</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span>  <span class="token punctuation">(</span><span class="token punctuation">`</span>tutorial_id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token punctuation">`</span>AUTHOR_INDEX<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>tutorial_author<span class="token punctuation">`</span><span class="token punctuation">)</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">)</span> <span class="token keyword">TYPE</span><span class="token operator">=</span>MyISAM<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">1.80</span> sec<span class="token punctuation">)</span>
</code></pre></div><h5 id="步骤三：">步骤三：</h5> <p>执行完步骤二之后，数据库就会有克隆表了。如果你还想要复制旧表中的数据的话，可以执行 INSERT INTO... SELECT 语句。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> CLONE_TBL <span class="token punctuation">(</span>tutorial_id<span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span>                        tutorial_title<span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span>                        tutorial_author<span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span>                        submission_date<span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> tutorial_id<span class="token punctuation">,</span>tutorial_title<span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span>        tutorial_author<span class="token punctuation">,</span>submission_date<span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">FROM</span> TUTORIALS_TBL<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">3</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.07</span> sec<span class="token punctuation">)</span>
Records: <span class="token number">3</span>  Duplicates: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>
</code></pre></div><p>最终，你将如期拥有一张完全相同的克隆表。</p> <h3 id="sql-索引">SQL 索引</h3> <hr> <p>索引是一种特殊的查询表，可以被数据库搜索引擎用来加速数据的检索。简单说来，索引就是指向表中数据的指针。数据库的索引同书籍后面的索引非常相像。</p> <p>例如，如果想要查阅一本书中与某个特定主题相关的所有页面，你会先去查询索引（索引按照字母表顺序列出了所有主题），然后从索引中找到一页或者多页与该主题相关的页面。</p> <p>索引能够提高 SELECT 查询和 WHERE 子句的速度，但是却降低了包含 UPDATE 语句或 INSERT 语句的数据输入过程的速度。索引的创建与删除不会对表中的数据产生影响。</p> <p>创建索引需要使用 CREATE INDEX 语句，该语句允许对索引命名，指定要创建索引的表以及对哪些列进行索引，还可以指定索引按照升序或者降序排列。</p> <p>同 UNIQUE 约束一样，索引可以是唯一的。这种情况下，索引会阻止列中（或者列的组合，其中某些列有索引）出现重复的条目。</p> <h3 id="create-index-命令：">CREATE INDEX 命令：</h3> <hr> <p><strong>CREATE INDEX</strong>命令的基本语法如下：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name<span class="token punctuation">;</span>
</code></pre></div><h5 id="单列索引：">单列索引：</h5> <p>单列索引基于单一的字段创建，其基本语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name
<span class="token keyword">ON</span> table_name <span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="唯一索引：">唯一索引：</h5> <p>唯一索引不止用于提升查询性能，还用于保证数据完整性。唯一索引不允许向表中插入任何重复值。其基本语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> index_name
<span class="token keyword">on</span> table_name <span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="聚簇索引：">聚簇索引：</h5> <p>聚簇索引在表中两个或更多的列的基础上建立。其基本语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name
<span class="token keyword">on</span> table_name <span class="token punctuation">(</span>column1<span class="token punctuation">,</span> column2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>创建单列索引还是聚簇索引，要看每次查询中，哪些列在作为过滤条件的 WHERE 子句中最常出现。</p> <p>如果只需要一列，那么就应当创建单列索引。如果作为过滤条件的 WHERE 子句用到了两个或者更多的列，那么聚簇索引就是最好的选择。</p> <h5 id="隐式索引：">隐式索引：</h5> <p>隐式索引由数据库服务器在创建某些对象的时候自动生成。例如，对于主键约束和唯一约束，数据库服务器就会自动创建索引。</p> <h3 id="drop-index-命令：">DROP INDEX 命令：</h3> <p>索引可以用 SQL <strong>DROP</strong> 命令删除。删除索引时应当特别小心，数据库的性能可能会因此而降低或者提高。</p> <p>其基本语法如下：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> table_name<span class="token punctuation">.</span>index_name<span class="token punctuation">;</span>
</code></pre></div><h3 id="什么时候应当避免使用索引？">什么时候应当避免使用索引？</h3> <hr> <p>尽管创建索引的目的是提升数据库的性能，但是还是有一些情况应当避免使用索引。下面几条指导原则给出了何时应当重新考虑是否使用索引：</p> <ul><li>小的数据表不应当使用索引；</li> <li>需要频繁进行大批量的更新或者插入操作的表；</li> <li>如果列中包含大数或者 NULL 值，不宜创建索引；</li> <li>频繁操作的列不宜创建索引。</li></ul> <h3 id="sql-子查询">SQL 子查询</h3> <hr> <p>子查询（Sub Query）或者说内查询（Inner Query），也可以称作嵌套查询（Nested Query），是一种嵌套在其他 SQL 查询的 WHERE 子句中的查询。</p> <p>子查询用于为主查询返回其所需数据，或者对检索数据进行进一步的限制。</p> <p>子查询可以在 SELECT、INSERT、UPDATE 和 DELETE 语句中，同 =、&lt;、&gt;、&gt;=、&lt;=、IN、BETWEEN 等运算符一起使用。</p> <p>使用子查询必须遵循以下几个规则：</p> <ul><li>子查询必须括在圆括号中。</li> <li>子查询的 SELECT 子句中只能有一个列，除非主查询中有多个列，用于与子查询选中的列相比较。</li> <li>子查询不能使用 ORDER BY，不过主查询可以。在子查询中，GROUP BY 可以起到同 ORDER BY 相同的作用。</li> <li>返回多行数据的子查询只能同多值操作符一起使用，比如 IN 操作符。</li> <li>SELECT 列表中不能包含任何对 BLOB、ARRAY、CLOB 或者 NCLOB 类型值的引用。</li> <li>子查询不能直接用在集合函数中。</li> <li>BETWEEN 操作符不能同子查询一起使用，但是 BETWEEN 操作符可以用在子查询中。</li></ul> <h3 id="select-语句中的子查询">SELECT 语句中的子查询</h3> <hr> <p>通常情况下子查询都与 SELECT 语句一起使用，其基本语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name <span class="token punctuation">[</span><span class="token punctuation">,</span> column_name <span class="token punctuation">]</span>
<span class="token keyword">FROM</span>   table1 <span class="token punctuation">[</span><span class="token punctuation">,</span> table2 <span class="token punctuation">]</span>
<span class="token keyword">WHERE</span>  column_name OPERATOR
      <span class="token punctuation">(</span><span class="token keyword">SELECT</span> column_name <span class="token punctuation">[</span><span class="token punctuation">,</span> column_name <span class="token punctuation">]</span>
      <span class="token keyword">FROM</span> table1 <span class="token punctuation">[</span><span class="token punctuation">,</span> table2 <span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token keyword">WHERE</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="示例：-2">示例：</h3> <hr> <p>考虑 CUSTOMERS 表，表中记录如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  35 | Ahmedabad |  2000.00 |
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><p>现在，让我们试一下在 SELECT 语句中进行子查询：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> 
     <span class="token keyword">FROM</span> CUSTOMERS 
     <span class="token keyword">WHERE</span> ID <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> ID 
                  <span class="token keyword">FROM</span> CUSTOMERS 
                  <span class="token keyword">WHERE</span> SALARY <span class="token operator">&gt;</span> <span class="token number">4500</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre></div><p>上述语句的执行结果如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+---------+----------+
| ID | NAME     | AGE | ADDRESS | SALARY   |
+----+----------+-----+---------+----------+
|  4 | Chaitali |  25 | Mumbai  |  6500.00 |
|  5 | Hardik   |  27 | Bhopal  |  8500.00 |
|  7 | Muffy    |  24 | Indore  | 10000.00 |
+----+----------+-----+---------+----------+
</code></pre></div><h3 id="insert-语句中的子查询：">INSERT 语句中的子查询：</h3> <hr> <p>子查询还可以用在 INSERT 语句中。INSERT 语句可以将子查询返回的数据插入到其他表中。子查询中选取的数据可以被任何字符、日期或者数值函数所修饰。</p> <p>其基本语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> table_name <span class="token punctuation">[</span> <span class="token punctuation">(</span>column1 <span class="token punctuation">[</span><span class="token punctuation">,</span> column2 <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
           <span class="token keyword">SELECT</span> <span class="token punctuation">[</span> <span class="token operator">*</span><span class="token operator">|</span>column1 <span class="token punctuation">[</span><span class="token punctuation">,</span> column2 <span class="token punctuation">]</span>
           <span class="token keyword">FROM</span> table1 <span class="token punctuation">[</span><span class="token punctuation">,</span> table2 <span class="token punctuation">]</span>
           <span class="token punctuation">[</span> <span class="token keyword">WHERE</span> <span class="token keyword">VALUE</span> OPERATOR <span class="token punctuation">]</span>
</code></pre></div><h3 id="示例：-3">示例：</h3> <hr> <p>考虑与 CUSTOMERS 表拥有相似结构的 CUSTOMERS_BKP 表。现在要将 CUSTOMER 表中所有的数据复制到 CUSTOMERS_BKP 表中，代码如下：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> CUSTOMERS_BKP
     <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> CUSTOMERS 
     <span class="token keyword">WHERE</span> ID <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> ID 
                  <span class="token keyword">FROM</span> CUSTOMERS<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre></div><h3 id="update-语句中的子查询：">UPDATE 语句中的子查询：</h3> <hr> <p>子查询可以用在 UPDATE 语句中。当子查询同 UPDATE 一起使用的时候，既可以更新单个列，也可更新多个列。</p> <p>其基本语法如下：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token keyword">table</span>
<span class="token keyword">SET</span> column_name <span class="token operator">=</span> new_value
<span class="token punctuation">[</span> <span class="token keyword">WHERE</span> OPERATOR <span class="token punctuation">[</span> <span class="token keyword">VALUE</span> <span class="token punctuation">]</span>
   <span class="token punctuation">(</span><span class="token keyword">SELECT</span> COLUMN_NAME
   <span class="token keyword">FROM</span> TABLE_NAME<span class="token punctuation">)</span>
   <span class="token punctuation">[</span> <span class="token keyword">WHERE</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
</code></pre></div><h3 id="示例：-4">示例：</h3> <hr> <p>假设我们有一份 CUSTOMERS_BKP 表作为 CUSTOMERS 表的备份。</p> <p>下面的示例将 CUSTOMERS 表中所有 AGE 大于或者等于 27 的客户的 SALARY 字段都变为了原来的 0.25 倍：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">UPDATE</span> CUSTOMERS
     <span class="token keyword">SET</span> SALARY <span class="token operator">=</span> SALARY <span class="token operator">*</span> <span class="token number">0.25</span>
     <span class="token keyword">WHERE</span> AGE <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> AGE <span class="token keyword">FROM</span> CUSTOMERS_BKP
                   <span class="token keyword">WHERE</span> AGE <span class="token operator">&gt;=</span> <span class="token number">27</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这将影响两行数据，随后 CUSTOMERS 表中的记录将如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  35 | Ahmedabad |   125.00 |
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  2125.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><h3 id="delete-语句中的子查询：">DELETE 语句中的子查询：</h3> <hr> <p>如同前面提到的其他语句一样，子查询还可以同 DELETE 语句一起使用。</p> <p>其基本语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> TABLE_NAME
<span class="token punctuation">[</span> <span class="token keyword">WHERE</span> OPERATOR <span class="token punctuation">[</span> <span class="token keyword">VALUE</span> <span class="token punctuation">]</span>
   <span class="token punctuation">(</span><span class="token keyword">SELECT</span> COLUMN_NAME
   <span class="token keyword">FROM</span> TABLE_NAME<span class="token punctuation">)</span>
   <span class="token punctuation">[</span> <span class="token keyword">WHERE</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
</code></pre></div><h3 id="示例：-5">示例：</h3> <hr> <p>假设我们有一份 CUSTOMERS_BKP 表作为 CUSTOMERS 表的备份。</p> <p>下面的示例将从 CUSTOMERS 表中删除所有 AGE 大于或者等于 27 的记录：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> CUSTOMERS
     <span class="token keyword">WHERE</span> AGE <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> AGE <span class="token keyword">FROM</span> CUSTOMERS_BKP
                   <span class="token keyword">WHERE</span> AGE <span class="token operator">&gt;</span> <span class="token number">27</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这将影响两行数据，随后 CUSTOMERS 表中的记录将如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+---------+----------+
| ID | NAME     | AGE | ADDRESS | SALARY   |
+----+----------+-----+---------+----------+
|  2 | Khilan   |  25 | Delhi   |  1500.00 |
|  3 | kaushik  |  23 | Kota    |  2000.00 |
|  4 | Chaitali |  25 | Mumbai  |  6500.00 |
|  6 | Komal    |  22 | MP      |  4500.00 |
|  7 | Muffy    |  24 | Indore  | 10000.00 |
+----+----------+-----+---------+----------+
</code></pre></div><h3 id="sql-truncate-table-命令">SQL TRUNCATE TABLE 命令</h3> <hr> <p>SQL <strong>TRUNCATE TABLE</strong> 命令用于删除现有数据表中的所有数据。</p> <p>你也可以使用 DROP TABLE 命令来删除整个数据表，不过 DROP TABLE 命令不但会删除表中所有数据，还会将整个表结构从数据库中移除。如果想要重新向表中存储数据的话，必须重建该数据表。</p> <h3 id="语法：">语法：</h3> <hr> <p><strong>TRUNCATE TABLE</strong> 的基本语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span>  table_name<span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-处理重复数据">SQL 处理重复数据</h3> <hr> <p>有时候，数据表中会存在相同的记录。在获取表中记录时，相较于取得重复记录来说，取得唯一的记录显然更有意义。</p> <p>我们之前讨论过的 SQL <strong>DISTINCT</strong> 关键字，与 SELECT 语句一起使用可以时，可以达到消除所有重复记录，只返回唯一记录的目的。</p> <h3 id="语法：-2">语法：</h3> <hr> <p>利用 DISTINCT 关键字来消除重复记录的基本语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>columnN 
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span>condition<span class="token punctuation">]</span>
</code></pre></div><h3 id="sql-使用视图">SQL 使用视图</h3> <hr> <p>视图无非就是存储在数据库中并具有名字的 SQL 语句，或者说是以预定义的 SQL 查询的形式存在的数据表的成分。</p> <p>视图可以包含表中的所有列，或者仅包含选定的列。视图可以创建自一个或者多个表，这取决于创建该视图的 SQL 语句的写法。</p> <p>视图，一种虚拟的表，允许用户执行以下操作：</p> <ul><li>以用户或者某些类型的用户感觉自然或者直观的方式来组织数据；</li> <li>限制对数据的访问，从而使得用户仅能够看到或者修改（某些情况下）他们需要的数据；</li> <li>从多个表中汇总数据，以产生报表。</li></ul> <h3 id="创建视图">创建视图</h3> <hr> <p>在 SQL 中，视图是基于 SQL 语句的结果集的可视化表。</p> <p>数据库视图由 <strong>CREATE VIEW</strong> 语句创建。视图可以创建自单个表、多个表或者其他视图。</p> <p>视图中的字段是一个或多个数据库中真实表中的字段。</p> <p>在使用时视图可以被视为一个“虚拟表”。</p> <p>要创建视图的话，用户必须有适当的系统权限。具体需要何种权限随数据库系统实现的不同而不同。</p> <p>CREATE VIEW 语句的基本语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> view_name <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span>condition<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>和普通的 SQL SELECT 查询一样，你可以在上面的 SELECT 语句中包含多个数据表。</p> <blockquote><p>注释：视图总是显示最新数据！每当用户查询视图时，数据库引擎就使用视图的 SQL 语句重新构建数据。</p></blockquote> <h3 id="sql-create-view-示例">SQL CREATE VIEW 示例</h3> <hr> <h5 id="示例一">示例一</h5> <p>考虑 CUSTOMERS 表，表中的记录如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  32 | Ahmedabad |  2000.00 |
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><p>下面是由 CUSTOMERS 表创建视图的例子。该视图包含来自 CUSTOMERS 表的顾客的名字（name）和年龄（age）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> CUSTOMERS_VIEW <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> age
<span class="token keyword">FROM</span>  CUSTOMERS<span class="token punctuation">;</span>
</code></pre></div><p>现在，你就可以像查询普通的数据表一样查询 CUSTOMERS_VIEW 了：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> CUSTOMERS_VIEW<span class="token punctuation">;</span>
</code></pre></div><p>上述语句将会产生如下运行结果：</p> <div class="language- extra-class"><pre class="language-text"><code>+----------+-----+
| name     | age |
+----------+-----+
| Ramesh   |  32 |
| Khilan   |  25 |
| kaushik  |  23 |
| Chaitali |  25 |
| Hardik   |  27 |
| Komal    |  22 |
| Muffy    |  24 |
+----------+-----+
</code></pre></div><h5 id="示例２">示例２</h5> <p>下面是由 CUSTOMERS 表创建视图的例子。该视图包含来自 CUSTOMERS 表中年龄（age）为25的顾客的ADDRESS信息：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> CUSTOMERS_ADDRESS <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> ADDRESS
<span class="token keyword">FROM</span>  CUSTOMERS<span class="token punctuation">;</span>
<span class="token keyword">WHERE</span> AGE<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span>
</code></pre></div><p>我们可以像这样查询上面这个 CUSTOMERS_ADDRESS 视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> CUSTOMERS_ADDRESS<span class="token punctuation">;</span>
</code></pre></div><p>我们也可以向查询添加条件。现在，我们仅仅需要查看 &quot;Delhi&quot; 的数据：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> CUSTOMERS_ADDRESS
<span class="token keyword">WHERE</span> ADDRESS<span class="token operator">=</span><span class="token string">'Delhi'</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="with-check-option">WITH CHECK OPTION</h3> <hr> <p>WITH CHECK OPTION 是 CREATE VIEW 语句的一个可选项。</p> <p>WITH CHECK OPTION 用于保证所有的 UPDATE 和 INSERT 语句都满足视图定义中的条件。</p> <p>如果不能满足这些条件，UPDATE 或 INSERT 就会返回错误。</p> <p>下面的例子创建的也是 CUSTOMERS_VIEW 视图，不过这次 WITH CHECK OPTION 是打开的：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> CUSTOMERS_VIEW <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> age
<span class="token keyword">FROM</span>  CUSTOMERS
<span class="token keyword">WHERE</span> age <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">WITH</span> <span class="token keyword">CHECK</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
</code></pre></div><p>这里 WITH CHECK OPTION 使得视图拒绝任何 AGE 字段为 NULL 的条目，因为视图的定义中，AGE 字段不能为空。</p> <h3 id="更新视图">更新视图</h3> <hr> <p>在SQL视图上也可以使用修改数据的DML语句，如 INSERT、UPDATE和DELETE。</p> <p>视图可以在特定的情况下更新：</p> <ul><li>SELECT 子句不能包含 DISTINCT 关键字</li> <li>SELECT 子句不能包含任何汇总函数（summary functions）</li> <li>SELECT 子句不能包含任何集合函数（set functions）</li> <li>SELECT 子句不能包含任何集合运算符（set operators）</li> <li>SELECT 子句不能包含 ORDER BY 子句</li> <li>视图不能包含连接操作符</li> <li>视图不能包含伪列或表达式</li> <li>FROM 子句中不能有多个数据表</li> <li>WHERE 子句不能包含子查询（subquery）</li> <li>查询语句中不能有 GROUP BY 或者 HAVING</li> <li>计算得出的列不能更新</li> <li>视图必须包含原始数据表中所有的 NOT NULL 列，从而使 INSERT 查询生效。</li></ul> <p>如果视图满足以上所有的条件，该视图就可以被更新。下面的例子中，Ramesh 的年龄被更新了：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token operator">&gt;</span> <span class="token keyword">UPDATE</span> CUSTOMERS_VIEW
      <span class="token keyword">SET</span> AGE <span class="token operator">=</span> <span class="token number">35</span>
      <span class="token keyword">WHERE</span> name<span class="token operator">=</span><span class="token string">'Ramesh'</span><span class="token punctuation">;</span>
</code></pre></div><p>最终更新的还是原始数据表，只是其结果反应在了视图上。现在查询原始数据表，SELECT 语句将会产生以下结果：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  35 | Ahmedabad |  2000.00 |
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><h3 id="向视图中插入新行">向视图中插入新行</h3> <hr> <p>可以向视图中插入新行，其规则同（使用 UPDATE 命令）更新视图所遵循的规则相同。</p> <p>这里我们不能向 CUSTOMERS_VIEW 视图中添加新行，因为该视图没有包含原始数据表中所有 NOT NULL 的列。否则的话，你就可以像在数据表中插入新行一样，向视图中插入新行。</p> <p>句法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> view_name
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>value1<span class="token punctuation">,</span> value2<span class="token punctuation">,</span> value3<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="删除视图中的行">删除视图中的行</h3> <hr> <p>视图中的数据行可以被删除。删除数据行与更新视图和向视图中插入新行遵循相同的规则。</p> <p>下面的例子将删除 CUSTOMERS_VIEW 视图中 AGE=22 的数据行：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token operator">&gt;</span> <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> CUSTOMERS_VIEW
      <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
</code></pre></div><p>该语句最终会将原始数据表中对应的数据行删除，只不过其结果反应在了视图上。现在查询原始数据表，SELECT 语句将会产生以下结果：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  35 | Ahmedabad |  2000.00 |
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><h3 id="删除视图">删除视图</h3> <hr> <p>很明显，当我们不再需要某个视图的时候，需要有一种方式可以让我们将其删除。删除视图的语法非常简单，如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> view_name<span class="token punctuation">;</span>
</code></pre></div><p>下面的例子展示了如何从 CUSTOMERS 表中删除 CUSTOMERS_VIEW 视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> CUSTOMERS_VIEW<span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-注入">SQL 注入</h3> <hr> <p>如果你从网页中获取用户输入，并将其插入到 SQL 数据库中的话，那么你很可能已经暴露于一种被称作 <strong>SQL 注入</strong>的安全风险之下了。</p> <p>本节将会教你如何防止 SQL 注入，以及如何保护 Perl 这样的服务器端脚本中的程序和 SQL 语句。</p> <p>注入通常发生在获取用户输入的时候，例如预期得到用户的名字，但是得到的却是一段很可能会在你不知情的情况下运行的 SQL 语句。</p> <p>绝对不要相信用户提供的数据，处理这些数据之前必须进行验证；通常，验证工作由模式匹配来完成。</p> <p>下面的例子中，<strong>name</strong> 仅限由字母、数字和下划线组成，并且长度在 8 到 20 之间（你可以根据需要修改这些规则）。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;/^\w{8,20}$/&quot;</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$matches</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;SELECT * FROM CUSTOMERS 
                          WHERE name=<span class="token interpolation"><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> 
<span class="token punctuation">{</span>
   <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;user name not accepted&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>为了展示问题所在，请考虑下面这段代码：</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// supposed input</span>
<span class="token variable">$name</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;Qadir'; DELETE FROM CUSTOMERS;&quot;</span><span class="token punctuation">;</span>
<span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;SELECT * FROM CUSTOMSRS WHERE name='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$name</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>下面的函数调用本来是要从 CUSTOMERS 表中取得 name 字段与用户给定的输入相匹配的记录。通常情况下，$name 只包含字母和数字，或许还有空格，例如字符串 ilia。但是，这里通过在 $name 上附加一段全新的查询语句，将原有的函数调用变为了数据库的灾难：注入的 DELETE 语句将会删除表中所有的记录。</p> <p>幸运的是，如果你在使用　MySQL 的话，mysql_query() 函数不允许查询堆积（query stacking），或者说在一次函数调用中执行多次 SQL 查询。如果你试图进行堆积式查询的话，函数调用将会失败。</p> <p>然而，其他的 PHP 数据库扩展，例如 SQLite 和 PostgreSQL 会愉快地接受堆积式查询，执行字符串中所有的查询，并由此产生严重的安全问题。</p> <h3 id="阻止-sql-注入">阻止 SQL 注入</h3> <hr> <p>你可以在 Perl 或者 PHP 等脚本语言中巧妙地处理所有的转义字符。PHP 的 MySQL 扩展提供了一个 mysql_real_escape_string() 函数，来转义那些对 MySQL 有特殊意义的字符。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">get_magic_quotes_gpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
  <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$name</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;SELECT * FROM CUSTOMERS WHERE name='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$name</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="like-困境">LIKE 困境</h3> <hr> <p>要破解 LIKE 困境，必须有一种专门的转义机制，将用户提供的 '%' 和 '_' 转换为字面值。为此你可以使用 addcslashes() 函数，该函数允许指定要进行转义的字符的范围。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$sub</span> <span class="token operator">=</span> <span class="token function">addcslashes</span><span class="token punctuation">(</span><span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;%str&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;%_&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// $sub == \%str\_</span>
<span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;SELECT * FROM messages 
             WHERE subject LIKE '<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$sub</span><span class="token punctuation">}</span></span>%'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-having-子句">SQL HAVING 子句</h3> <hr> <p>HAVING 子句使你能够指定过滤条件，从而控制查询结果中哪些组可以出现在最终结果里面。</p> <p>WHERE 子句对被选择的列施加条件，而 HAVING 子句则对 GROUP BY 子句所产生的组施加条件。</p> <h5 id="语法">语法</h5> <p>下面可以看到 HAVING 子句在 SEL ECT 查询中的位置：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
<span class="token keyword">FROM</span>
<span class="token keyword">WHERE</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
<span class="token keyword">HAVING</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
</code></pre></div><p>在 SELECT 查询中，HAVING 子句必须紧随 GROUP BY 子句，并出现在 ORDER BY 子句（如果有的话）之前。带有 HAVING 子句的 SELECT 语句的语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column1<span class="token punctuation">,</span> column2   
<span class="token keyword">FROM</span> table1<span class="token punctuation">,</span> table2
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span> conditions <span class="token punctuation">]</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> column1<span class="token punctuation">,</span> column2
<span class="token keyword">HAVING</span> <span class="token punctuation">[</span> conditions <span class="token punctuation">]</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> column1<span class="token punctuation">,</span> column2
</code></pre></div><h3 id="sql-事务">SQL 事务</h3> <hr> <p>事务是在数据库上按照一定的逻辑顺序执行的任务序列，既可以由用户手动执行，也可以由某种数据库程序自动执行。</p> <p>事务实际上就是对数据库的一个或者多个更改。当你在某张表上创建更新或者删除记录的时，你就已经在使用事务了。控制事务以保证数据完整性，并对数据库错误做出处理，对数据库来说非常重要。</p> <p>实践中，通常会将很多 SQL 查询组合在一起，并将其作为某个事务一部分来执行。</p> <h3 id="事务的属性">事务的属性</h3> <hr> <p>事务具有以下四个标准属性，通常用缩略词 ACID 来表示：</p> <ul><li>**原子性：**保证任务中的所有操作都执行完毕；否则，事务会在出现错误时终止，并回滚之前所有操作到原始状态。</li> <li>**一致性：**如果事务成功执行，则数据库的状态得到了进行了正确的转变。</li> <li>**隔离性：**保证不同的事务相互独立、透明地执行。</li> <li>**持久性：**即使出现系统故障，之前成功执行的事务的结果也会持久存在。</li></ul> <h3 id="事务控制">事务控制</h3> <hr> <p>有四个命令用于控制事务：</p> <ul><li>**COMMIT：**提交更改；</li> <li>**ROLLBACK：**回滚更改；</li> <li>**SAVEPOINT：**在事务内部创建一系列可以 ROLLBACK 的还原点；</li> <li>**SET TRANSACTION：**命名事务；</li></ul> <h3 id="commit-命令">COMMIT 命令</h3> <hr> <p>COMMIT 命令用于保存事务对数据库所做的更改。</p> <p>COMMIT 命令会将自上次 COMMIT 命令或者 ROLLBACK 命令执行以来所有的事务都保存到数据库中。</p> <p>COMMIT 命令的语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="示例">示例</h3> <hr> <p>考虑 CUSTOMERS 表，表中的记录如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  32 | Ahmedabad |  2000.00 |
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><p>下面的示例将会删除表中 age=25 的记录，然后将更改提交（COMMIT）到数据库中。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> CUSTOMERS
     <span class="token keyword">WHERE</span> AGE <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre></div><p>上述语句将会从表中删除两行记录，再执行 SELECT 语句将会得到如下结果：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  32 | Ahmedabad |  2000.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><h3 id="rollback-命令">ROLLBACK 命令</h3> <hr> <p>ROLLBACK 命令用于撤销尚未保存到数据库中的事务。</p> <p>ROLLBACK 命令只能撤销自上次 COMMIT 命令或者 ROLLBACK 命令执行以来的事务。</p> <p>ROLLBACK 命令的语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="示例：-6">示例：</h3> <hr> <p>考虑 CUSTOMERS 表，表中的记录如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  32 | Ahmedabad |  2000.00 |
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><p>下面的示例将会从表中删除所有 age=25 的记录，然后回滚（ROLLBACK）对数据库所做的更改。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> CUSTOMERS
     <span class="token keyword">WHERE</span> AGE <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>
</code></pre></div><p>结果是删除操作并不会对数据库产生影响。现在，执行 SELECT 语句将会得到如下结果：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  32 | Ahmedabad |  2000.00 |
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><h3 id="savepoint-命令">SAVEPOINT 命令</h3> <hr> <p>SAVEPOINT 是事务中的一个状态点，使得我们可以将事务回滚至特定的点，而不是将整个事务都撤销。</p> <p>SAVEPOINT 命令的记录如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SAVEPOINT</span> SAVEPOINT_NAME<span class="token punctuation">;</span>
</code></pre></div><p>该命令只能在事务语句之间创建保存点（SAVEPOINT）。ROLLBACK 命令可以用于撤销一系列的事务。</p> <p>回滚至某一保存点的语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ROLLBACK</span> <span class="token keyword">TO</span> SAVEPOINT_NAME<span class="token punctuation">;</span>
</code></pre></div><p>下面的示例中，你计划从 CUSTOMERS 表中删除三条不同的记录，并在每次删除之前创建一个保存点（SAVEPOINT），从而使得你可以在任何任何时候回滚到任意的保存点，以恢复数据至其原始状态。</p> <h3 id="示例-2">示例</h3> <hr> <p>考虑 CUSTOMERS 表，表中的记录如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  1 | Ramesh   |  32 | Ahmedabad |  2000.00 |
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
</code></pre></div><p>操作序列如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SAVEPOINT</span> SP1<span class="token punctuation">;</span>
<span class="token keyword">Savepoint</span> created<span class="token punctuation">.</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> CUSTOMERS <span class="token keyword">WHERE</span> ID<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token number">1</span> <span class="token keyword">row</span> deleted<span class="token punctuation">.</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SAVEPOINT</span> SP2<span class="token punctuation">;</span>
<span class="token keyword">Savepoint</span> created<span class="token punctuation">.</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> CUSTOMERS <span class="token keyword">WHERE</span> ID<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token number">1</span> <span class="token keyword">row</span> deleted<span class="token punctuation">.</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SAVEPOINT</span> SP3<span class="token punctuation">;</span>
<span class="token keyword">Savepoint</span> created<span class="token punctuation">.</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> CUSTOMERS <span class="token keyword">WHERE</span> ID<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token number">1</span> <span class="token keyword">row</span> deleted<span class="token punctuation">.</span>
</code></pre></div><p>现在，三次删除操作已经生效了，如果此时你改变主意决定回滚至名字为 SP2 的保存点，由于 SP2 于第一次删除操作之后创建，所以后两次删除操作将会被撤销。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">ROLLBACK</span> <span class="token keyword">TO</span> SP2<span class="token punctuation">;</span>
<span class="token keyword">Rollback</span> complete<span class="token punctuation">.</span>
</code></pre></div><p>注意，由于你将数据库回滚至 SP2，所以只有第一次删除真正起效了：</p> <div class="language- extra-class"><pre class="language-text"><code>SQL&gt; SELECT * FROM CUSTOMERS;
+----+----------+-----+-----------+----------+
| ID | NAME     | AGE | ADDRESS   | SALARY   |
+----+----------+-----+-----------+----------+
|  2 | Khilan   |  25 | Delhi     |  1500.00 |
|  3 | kaushik  |  23 | Kota      |  2000.00 |
|  4 | Chaitali |  25 | Mumbai    |  6500.00 |
|  5 | Hardik   |  27 | Bhopal    |  8500.00 |
|  6 | Komal    |  22 | MP        |  4500.00 |
|  7 | Muffy    |  24 | Indore    | 10000.00 |
+----+----------+-----+-----------+----------+
6 rows selected.
</code></pre></div><h3 id="release-savepoint-命令">RELEASE SAVEPOINT 命令</h3> <hr> <p>RELEASE SAVEPOINT 命令用于删除先前创建的保存点。</p> <p>RELEASE SAVEPOINT 的语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">RELEASE</span> <span class="token keyword">SAVEPOINT</span> SAVEPOINT_NAME<span class="token punctuation">;</span>
</code></pre></div><p>保存点一旦被释放，你就不能够再用 ROLLBACK 命令来撤销该保存点之后的事务了。</p> <h3 id="set-transaction-命令">SET TRANSACTION 命令</h3> <hr> <p>SET TRANSACTION 命令可以用来初始化数据库事务，指定随后的事务的各种特征。</p> <p>例如，你可以将某个事务指定为只读或者读写。</p> <p>SET TRANSACTION 命令的语法如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token keyword">TRANSACTION</span> <span class="token punctuation">[</span> <span class="token keyword">READ</span> <span class="token keyword">WRITE</span> <span class="token operator">|</span> <span class="token keyword">READ</span> ONLY <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-临时表">SQL 临时表</h3> <hr> <p>某些关系型数据库管理系统支持临时表。临时表是一项很棒的特性，能够让你像操作普通的 SQL 数据表一样，使用 SELECT、UPDATE 和 JOIN 等功能来存储或者操作中间结果。</p> <p>临时表有时候对于保存临时数据非常有用。有关临时表你需要知道的最重要的一点是，它们会在当前的终端会话结束后被删除。</p> <p>临时表自 MySQL 3.23 起受到支持。如果你的 MySQL 版本比 3.23 还老，那么你就不能使用临时表了，不过你可以使用堆表（heap table）。</p> <p>如先前所言，临时表只在会话期间存在。如果你在 PHP 脚本中操作数据库，那么临时表将在脚本执行完毕时被自动销毁。如果你是通过 MySQL 的客户端程序连接到 MySQL 数据库服务器的，那么临时表将会存在到你关闭客户端或者手动将其删除。</p> <h3 id="示例-3">示例</h3> <hr> <p>下面的示例向你展示了如何使用临时表：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">TEMPORARY</span> <span class="token keyword">TABLE</span> SALESSUMMARY <span class="token punctuation">(</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> product_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">,</span> total_sales <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0.00</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">,</span> avg_unit_price <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0.00</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">,</span> total_units_sold <span class="token keyword">INT</span> <span class="token keyword">UNSIGNED</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SALESSUMMARY
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>product_name<span class="token punctuation">,</span> total_sales<span class="token punctuation">,</span> avg_unit_price<span class="token punctuation">,</span> total_units_sold<span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">VALUES</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token string">'cucumber'</span><span class="token punctuation">,</span> <span class="token number">100.25</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SALESSUMMARY<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------+-------------+----------------+------------------+</span>
<span class="token operator">|</span> product_name <span class="token operator">|</span> total_sales <span class="token operator">|</span> avg_unit_price <span class="token operator">|</span> total_units_sold <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+-------------+----------------+------------------+</span>
<span class="token operator">|</span> cucumber     <span class="token operator">|</span>      <span class="token number">100.25</span> <span class="token operator">|</span>          <span class="token number">90.00</span> <span class="token operator">|</span>                <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+-------------+----------------+------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><p>当你下达 <strong>SHOW TABLES</strong> 命令的时候，临时表是不会出现在结果列表当中的。现在，如果你退出 MySQL 会话，然后再执行 SELECT 命令的话，你将不能从数据库中取回任何数据，你的临时表也已经不复存在了。</p> <h3 id="删除临时表">删除临时表</h3> <hr> <p>默认情况下，所有的临时表都由 MySQL 在数据库连接关闭时删除。不过，有时候你还是会想要在会话期间将其删除，此时你需要使用 DROP TABLE 命令来达到目的。</p> <p>下面是删除临时表的示例：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">TEMPORARY</span> <span class="token keyword">TABLE</span> SALESSUMMARY <span class="token punctuation">(</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> product_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">,</span> total_sales <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0.00</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">,</span> avg_unit_price <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0.00</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">,</span> total_units_sold <span class="token keyword">INT</span> <span class="token keyword">UNSIGNED</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SALESSUMMARY
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>product_name<span class="token punctuation">,</span> total_sales<span class="token punctuation">,</span> avg_unit_price<span class="token punctuation">,</span> total_units_sold<span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">VALUES</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token string">'cucumber'</span><span class="token punctuation">,</span> <span class="token number">100.25</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SALESSUMMARY<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------+-------------+----------------+------------------+</span>
<span class="token operator">|</span> product_name <span class="token operator">|</span> total_sales <span class="token operator">|</span> avg_unit_price <span class="token operator">|</span> total_units_sold <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+-------------+----------------+------------------+</span>
<span class="token operator">|</span> cucumber     <span class="token operator">|</span>      <span class="token number">100.25</span> <span class="token operator">|</span>          <span class="token number">90.00</span> <span class="token operator">|</span>                <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+-------------+----------------+------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> SALESSUMMARY<span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span>  <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SALESSUMMARY<span class="token punctuation">;</span>
ERROR <span class="token number">1146</span>: <span class="token keyword">Table</span> <span class="token string">'TUTORIALS.SALESSUMMARY'</span> doesn't exist
</code></pre></div><h2 id="sql-函数">SQL 函数</h2> <h3 id="sql-函数-2">SQL 函数</h3> <hr> <p>SQL 拥有很多可用于计数和计算的内建函数。</p> <h3 id="sql-aggregate-函数">SQL Aggregate 函数</h3> <hr> <p>SQL Aggregate 函数计算从列中取得的值，返回一个单一的值。</p> <p>有用的 Aggregate 函数：</p> <ul><li>AVG() - 返回平均值</li> <li>COUNT() - 返回行数</li> <li>FIRST() - 返回第一个记录的值</li> <li>LAST() - 返回最后一个记录的值</li> <li>MAX() - 返回最大值</li> <li>MIN() - 返回最小值</li> <li>SUM() - 返回总和</li></ul> <h3 id="sql-scalar-函数">SQL Scalar 函数</h3> <hr> <p>SQL Scalar 函数基于输入值，返回一个单一的值。</p> <p>有用的 Scalar 函数：</p> <ul><li>UCASE() - 将某个字段转换为大写</li> <li>LCASE() - 将某个字段转换为小写</li> <li>MID() - 从某个文本字段提取字符</li> <li>LEN() - 返回某个文本字段的长度</li> <li>ROUND() - 对某个数值字段进行指定小数位数的四舍五入</li> <li>NOW() - 返回当前的系统日���和时间</li> <li>FORMAT() - 格式化某个字段的显示方式</li></ul> <blockquote><p>**提示：**在下面的章节，我们会详细讲解 Aggregate 函数和 Scalar 函数。</p></blockquote> <h3 id="sql-max-函数">SQL MAX() 函数</h3> <hr> <h5 id="max-函数">MAX() 函数</h5> <p>MAX() 函数返回所选列的最大值。</p> <h5 id="sql-max-语法">SQL MAX() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-min-function">SQL MIN() Function</h3> <hr> <h5 id="min-函数">MIN() 函数</h5> <p>MIN() 函数返回所选列的最小值。</p> <h5 id="sql-min-语法">SQL MIN() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-count-函数">SQL COUNT() 函数</h3> <hr> <p>COUNT() 函数返回符合指定条件的行数。</p> <h5 id="sql-count-column-name-语法">SQL COUNT(column_name) 语法</h5> <p>COUNT(column_name) 函数返回指定列的值的数目（NULL 不计入）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>
</code></pre></div><h5 id="sql-count-语法">SQL COUNT(*) 语法</h5> <p>COUNT(*) 函数返回表中的记录数：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
</code></pre></div><h5 id="sql-count-distinct-column-name-语法">SQL COUNT(DISTINCT column_name) 语法</h5> <p>COUNT(DISTINCT column_name) 函数返回指定列的不同值的数目：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
</code></pre></div><p>**注释：**COUNT(DISTINCT) 适用于 ORACLE 和 Microsoft SQL Server，但是无法用于 Microsoft Access。</p> <h3 id="sql-avg-函数">SQL AVG() 函数</h3> <hr> <h5 id="avg-函数">AVG() 函数</h5> <p>AVG() 函数返回数字列的平均值。</p> <h5 id="sql-avg-语法">SQL AVG() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-sum-函数">SQL SUM() 函数</h3> <hr> <p>SUM() 函数返回数字列的总和。</p> <h5 id="sql-sum-语法">SQL SUM() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-日期函数">SQL 日期函数</h3> <hr> <p>下面的列表中是 SQL 中所有与日期和时间相关的重要函数。你所用的 RDBMS 可能会支持更多其他的函数。下面的列表基于 MySQL 关系型数据库管理系统。</p> <table><thead><tr><th>名称</th> <th>描述</th></tr></thead> <tbody><tr><td>ADDDATE()</td> <td>增加日期</td></tr> <tr><td>ADDTIME()</td> <td>增加时间</td></tr> <tr><td>CONVERT_TZ()</td> <td>将当前时区更改为另一时区</td></tr> <tr><td>CURDATE()</td> <td>返回当前日期</td></tr> <tr><td>CURRENT_DATE(), CURRENT_DATE</td> <td>CURDATE() 的别名</td></tr> <tr><td>CURRENT_TIME(), CURRENT_TIME</td> <td>CURTIME() 的别名</td></tr> <tr><td>CURRENT_TIMESTAMP(), CURRENT_TIMESTAMP</td> <td>NOW() 的别名</td></tr> <tr><td>CURTIME()</td> <td>返回当前时间</td></tr> <tr><td>DATE_ADD()</td> <td>将两个日期相加</td></tr> <tr><td>DATE_FORMAT()</td> <td>按照指定格式格式化日期</td></tr> <tr><td>DATE_SUB()</td> <td>将两个日期相减</td></tr> <tr><td>DATE()</td> <td>从 date 或者 datetime 表达式中提取出日期部分</td></tr> <tr><td>DATEDIFF()</td> <td>将两个日期相减</td></tr> <tr><td>DAY()</td> <td>DAYOFMONTH() 的别名</td></tr> <tr><td>DAYNAME()</td> <td>返回某天在用星期中的名称</td></tr> <tr><td>DAYOFMONTH()</td> <td>返回某天是当月的第几天 （1-31）</td></tr> <tr><td>DAYOFWEEK()</td> <td>返回某天是该星期的第几天</td></tr> <tr><td>DAYOFYEAR()</td> <td>返回某天是一年中的第几天（1-366）</td></tr> <tr><td>EXTRACT</td> <td>提取日期中的某一部分</td></tr> <tr><td>FROM_DAYS()</td> <td>将天数转换为日期</td></tr> <tr><td>FROM_UNIXTIME()</td> <td>将某个日期格式化为 UNIX 时间戳</td></tr> <tr><td>HOUR()</td> <td>提取小时</td></tr> <tr><td>LAST_DAY</td> <td>返回参数日期所在月份的最后一天</td></tr> <tr><td>LOCALTIME(), LOCALTIME</td> <td>NOW() 的别名</td></tr> <tr><td>LOCALTIMESTAMP, LOCALTIMESTAMP()</td> <td>NOW() 的别名</td></tr> <tr><td>MAKEDATE()</td> <td>利用年份和某天在该年所处的天数来创建日期</td></tr> <tr><td>MAKETIME</td> <td>MAKETIME()</td></tr> <tr><td>MICROSECOND()</td> <td>由参数返回微秒</td></tr> <tr><td>MINUTE()</td> <td>由参数返回分钟</td></tr> <tr><td>MONTH()</td> <td>返回日期参数的月份</td></tr> <tr><td>MONTHNAME()</td> <td>返回月份的名字</td></tr> <tr><td>NOW()</td> <td>返回当前日期和时间</td></tr> <tr><td>PERIOD_ADD()</td> <td>向年月格式的日期数据之间添加一段时间</td></tr> <tr><td>PERIOD_DIFF()</td> <td>返回两个年月格式的日期数据之间的月份数</td></tr> <tr><td>QUARTER()</td> <td>返回日期参数所在的季度</td></tr> <tr><td>SEC_TO_TIME()</td> <td>将秒数转换为 'HH:MM:SS' 格式</td></tr> <tr><td>SECOND()</td> <td>返回参数中的秒数 (0-59)</td></tr> <tr><td>STR_TO_DATE()</td> <td>将字符串转换为日期数据</td></tr> <tr><td>SUBDATE()</td> <td>以三个参数调用的时候是 DATE_SUB() 的同义词</td></tr> <tr><td>SUBTIME()</td> <td>减去时间</td></tr> <tr><td>SYSDATE()</td> <td>返回函数执行的时的时刻</td></tr> <tr><td>TIME_FORMAT()</td> <td>格式化时间</td></tr> <tr><td>TIME_TO_SEC()</td> <td>将时间参数转换为秒数</td></tr> <tr><td>TIME()</td> <td>返回参数表达式中的时间部分</td></tr> <tr><td>TIMEDIFF()</td> <td>将两个时间相减</td></tr> <tr><td>TIMESTAMP()</td> <td>只有一个参数时，该函数返回 date 或者 datetime 表达式。当有两个参数时，将两个参数相加。</td></tr> <tr><td>TIMESTAMPADD()</td> <td>在 datetime 表达式上加上一段时间</td></tr> <tr><td>TIMESTAMPDIFF()</td> <td>在 datetime 表达式上减去一段时间</td></tr> <tr><td>TO_DAYS()</td> <td>将日期参数转换为天数</td></tr> <tr><td>UNIX_TIMESTAMP()</td> <td>返回 UNIX 时间戳</td></tr> <tr><td>UTC_DATE()</td> <td>返回当前 UTC 日期</td></tr> <tr><td>UTC_TIME()</td> <td>返回当前 UTC 时间</td></tr> <tr><td>UTC_TIMESTAMP()</td> <td>返回当前 UTC 日期和时间</td></tr> <tr><td>WEEK()</td> <td>返回参数的星期数</td></tr> <tr><td>WEEKDAY()</td> <td>返回日期参数时一个星期中的第几天</td></tr> <tr><td>WEEKOFYEAR()</td> <td>返回日期参数是日历上的第几周 (1-53)</td></tr> <tr><td>YEAR()</td> <td>返回日期参数中的年份</td></tr> <tr><td>YEARWEEK()</td> <td>返回年份和星期</td></tr></tbody></table> <h3 id="adddate-date-interval-expr-unit-adddate-expr-days">ADDDATE(date, INTERVAL expr unit), ADDDATE(expr, days)</h3> <hr> <p>如果调用时第二个参数为 INTERVAL 形式的话，ADDDATE() 就是 DATE_ADD() 的同义词。同样的情况下，SUBDATE() 是 DATE_SUB() 的同义词。有关 INTERVAL 单位参数的信息，见有关 DATE_ADD() 的讨论。</p> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt; SELECT DATE_ADD('1998-01-02', INTERVAL 31 DAY);
+---------------------------------------------------------+
| DATE_ADD('1998-01-02', INTERVAL 31 DAY)                 |
+---------------------------------------------------------+
| 1998-02-02                                              |
+---------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; SELECT ADDDATE('1998-01-02', INTERVAL 31 DAY);
+---------------------------------------------------------+
| ADDDATE('1998-01-02', INTERVAL 31 DAY)                  |
+---------------------------------------------------------+
| 1998-02-02                                              |
+---------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div><p>如果调用时第二个参数为天数形式的话，则 MySQL 会将其作为整数加到 expr 上。</p> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt; SELECT ADDDATE('1998-01-02', 31);
+---------------------------------------------------------+
| DATE_ADD('1998-01-02', INTERVAL 31 DAY)                 |
+---------------------------------------------------------+
| 1998-02-02                                              |
+---------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div><h3 id="addtime-expr1-expr2">ADDTIME(expr1,expr2)</h3> <hr> <p>ADDTIME() 将 expr2 加到 expr1 上，并返回结果。expr1 为 time 或者 datetime 表达式，expr2 为 time 表达式。</p> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt; SELECT ADDTIME('1997-12-31 23:59:59.999999','1 1:1:1.000002');
+---------------------------------------------------------+
| DATE_ADD('1997-12-31 23:59:59.999999','1 1:1:1.000002') |
+---------------------------------------------------------+
| 1998-01-02 01:01:01.000001                              |
+---------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div><h3 id="convert-tz-dt-from-tz-to-tz">CONVERT_TZ(dt,from_tz,to_tz)</h3> <hr> <p>该函数将 datetime 类型的值 dt 的时区从 from_dt 转换为 to_dt，并返回结果。如果参数无效，则函数返回 NULL。</p> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt; SELECT CONVERT_TZ('2004-01-01 12:00:00','GMT','MET');
+---------------------------------------------------------+
| CONVERT_TZ('2004-01-01 12:00:00','GMT','MET')           |
+---------------------------------------------------------+
| 2004-01-01 13:00:00                                     |
+---------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; SELECT CONVERT_TZ('2004-01-01 12:00:00','+00:00','+10:00');
+---------------------------------------------------------+
| CONVERT_TZ('2004-01-01 12:00:00','+00:00','+10:00')     |
+---------------------------------------------------------+
| 2004-01-01 22:00:00                                     |
+---------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div><h3 id="curdate">CURDATE()</h3> <hr> <p>以 'YYYY-MM-DD'（字符串） 或者 YYYYMMDD（数值） 的形式返回当前日期， 具体形式取决于函数处于字符串还是数值型的上下文环境中。</p> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt; SELECT CURDATE();
+---------------------------------------------------------+
| CURDATE()                                               |
+---------------------------------------------------------+
| 1997-12-15                                              |
+---------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; SELECT CURDATE() + 0;
+---------------------------------------------------------+
| CURDATE() + 0                                           |
+---------------------------------------------------------+
| 19971215                                                |
+---------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div><h3 id="current-date-and-current-date">CURRENT_DATE and CURRENT_DATE()</h3> <hr> <p>CURRENT_DATE 和 CURRENT_DATE() 是 CURDATE() 的别名。</p> <h3 id="curtime">CURTIME()</h3> <hr> <p>以 'HH:MM:SS'（字符串） 或者 HHMMSS（数值） 的形式返回当前时间， 具体形式取决于函数处于字符串还是数值型的上下文环境中。该函数按照当前时区来表示返回值。</p> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt; SELECT CURTIME();
+---------------------------------------------------------+
| CURTIME()                                               |
+---------------------------------------------------------+
| 23:50:26                                                |
+---------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; SELECT CURTIME() + 0;
+---------------------------------------------------------+
| CURTIME() + 0                                           |
+---------------------------------------------------------+
| 235026                                                  |
+---------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div><h3 id="current-time-and-current-time">CURRENT_TIME and CURRENT_TIME()</h3> <hr> <p>CURRENT_TIME 和 CURRENT_TIME() 是 CURTIME() 的别名。</p> <h3 id="current-timestamp-and-current-timestamp">CURRENT_TIMESTAMP and CURRENT_TIMESTAMP()</h3> <hr> <p>CURRENT_TIMESTAMP 和 CURRENT_TIMESTAMP() 是 NOW() 的别名。</p> <h3 id="date-expr">DATE(expr)</h3> <hr> <p>提取 date 表达式或者 datetime 表达式中的日期部分。</p> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt; SELECT DATE('2003-12-31 01:02:03');
+---------------------------------------------------------+
| DATE('2003-12-31 01:02:03')                             |
+---------------------------------------------------------+
|  2003-12-31                                             |
+---------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div><h3 id="datediff-expr1-expr2">DATEDIFF(expr1,expr2)</h3> <hr> <p>DATEDIFF() 返回 expr1 和 expr2 的差，以天数的形式表示。expr1 和 expr2 应为 date 或者 datetime 表达式。只有参数的日期部分参与了计算。</p> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt; SELECT DATEDIFF('1997-12-31 23:59:59','1997-12-30');
+---------------------------------------------------------+
| DATEDIFF('1997-12-31 23:59:59','1997-12-30')            |
+---------------------------------------------------------+
| 1                                                       |
+---------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div><h3 id="date-add-date-interval-expr-unit-date-sub-date-interval-expr-unit">DATE_ADD(date,INTERVAL expr unit), DATE_SUB(date,INTERVAL expr unit)</h3> <hr> <p>这些函数进行有关日期的算术运算。date 是一个 DATETIME 或者 DATE 类型的值，指明了起始时间。expr 表达式则是 date 要增加或者减去的时间间隔。expr 是一个字符串，可以以 '-' 开始来表示负时间区间。 unit 是一个关键词，指明了expr 的单位。</p> <p>INTERVAL 关键字和 unit（单位）指示符不区分大小写。</p> <p>下表列出了对于每种单位，expr 应有的形式。</p> <table><thead><tr><th>unit 值</th> <th>expr 应有的格式</th></tr></thead> <tbody><tr><td>MICROSECOND</td> <td>微秒</td></tr> <tr><td>SECOND</td> <td>秒</td></tr> <tr><td>MINUTE</td> <td>分钟</td></tr> <tr><td>HOUR</td> <td>小时</td></tr> <tr><td>DAY</td> <td>天</td></tr> <tr><td>WEEK</td> <td>星期</td></tr> <tr><td>MONTH</td> <td>月</td></tr> <tr><td>QUARTER</td> <td>季度</td></tr> <tr><td>YEAR</td> <td>年</td></tr> <tr><td>SECOND_MICROSECOND</td> <td>'秒.微秒'</td></tr> <tr><td>MINUTE_MICROSECOND</td> <td>'分.微秒'</td></tr> <tr><td>MINUTE_SECOND</td> <td>'分:秒'</td></tr> <tr><td>HOUR_MICROSECOND</td> <td>'小时.微秒'</td></tr> <tr><td>HOUR_SECOND</td> <td>'时:分:秒'</td></tr> <tr><td>HOUR_MINUTE</td> <td>'时:分'</td></tr> <tr><td>DAY_MICROSECOND</td> <td>'天.微秒'</td></tr> <tr><td>DAY_SECOND</td> <td>'天 时:分:秒'</td></tr> <tr><td>DAY_MINUTE</td> <td>'天 时:分'</td></tr> <tr><td>DAY_HOUR</td> <td>'天 时'</td></tr> <tr><td>YEAR_MONTH</td> <td>'年-月'</td></tr></tbody></table> <p>QUARTER 和 WEEK 自 MySQL 5.0.0 起受到支持。</p> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt; SELECT DATE_ADD('1997-12-31 23:59:59', 
    -&gt; INTERVAL '1:1' MINUTE_SECOND);
+---------------------------------------------------------+
| DATE_ADD('1997-12-31 23:59:59', INTERVAL...             |
+---------------------------------------------------------+
| 1998-01-01 00:01:00                                     |
+---------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; SELECT DATE_ADD('1999-01-01', INTERVAL 1 HOUR);
+---------------------------------------------------------+
| DATE_ADD('1999-01-01', INTERVAL 1 HOUR)                 |
+---------------------------------------------------------+
| 1999-01-01 01:00:00                                     |
+---------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div><h3 id="date-format-date-format">DATE_FORMAT(date,format)</h3> <hr> <p>根据格式字符串对日期值进行格式化。</p> <p>下面这些占位符可以用在格式字符串中，'%' 必须出现在特定的格式字符之前。</p> <table><thead><tr><th>占位符</th> <th>描述</th></tr></thead> <tbody><tr><td>%a</td> <td>简写的星期名称（Sun..Sat）</td></tr> <tr><td>%b</td> <td>简写的月份名称 （Jan..Dec）</td></tr> <tr><td>%c</td> <td>月份，以数值形式表示（0..12）</td></tr> <tr><td>%D</td> <td>月份中的日期，带有英文后缀（0th，1st，2nd，3rd 等等）</td></tr> <tr><td>%d</td> <td>月份中的日期，以数值表示 (00..31)</td></tr> <tr><td>%e</td> <td>月份中的日期，以数值表示 (0..31)</td></tr> <tr><td>%f</td> <td>微秒（000000..999999）</td></tr> <tr><td>%H</td> <td>小时(00..23)</td></tr> <tr><td>%h</td> <td>小时(01..12)</td></tr> <tr><td>%I</td> <td>小时(01..12)</td></tr> <tr><td>%i</td> <td>分钟,以数值表示(00..59)</td></tr> <tr><td>%j</td> <td>一年中的第几天（001..366）</td></tr> <tr><td>%k</td> <td>小时（0..23）</td></tr> <tr><td>%l</td> <td>小时（1..12）</td></tr> <tr><td>%M</td> <td>月份的名称（January..December）</td></tr> <tr><td>%m</td> <td>月份，以数值形式表示（00..12）</td></tr> <tr><td>%p</td> <td>AM 或者 PM</td></tr> <tr><td>%r</td> <td>时间，12 小时制(hh:mm:ss followed by AM or PM)</td></tr> <tr><td>%S</td> <td>秒(00..59)</td></tr> <tr><td>%s</td> <td>秒(00..59)</td></tr> <tr><td>%T</td> <td>时间，24小时制（hh:mm:ss）</td></tr> <tr><td>%U</td> <td>星期（00..53），此处星期日为一周的第一天</td></tr> <tr><td>%u</td> <td>星期（00..53），此处星期一为一周的第一天</td></tr> <tr><td>%V</td> <td>星期（01..53），此处星期日为一周的第一天；与 %X 一起使用。</td></tr> <tr><td>%v</td> <td>星期（01..53），此处星期一为一周的第一天；与 %x 一起使用。</td></tr> <tr><td>%W</td> <td>一周中日期的名称（Sunday..Saturday）</td></tr> <tr><td>%w</td> <td>一周中的第几天（0=Sunday..6=Saturday）</td></tr> <tr><td>%X</td> <td>以星期日为第一天的周所处的年份，四位数字表示；同 %V 一起使用。</td></tr> <tr><td>%x</td> <td>以星期一为第一天的周所处的年份，四位数字表示；同 %v 一起使用。</td></tr> <tr><td>%Y</td> <td>年份，四位数字表示。</td></tr> <tr><td>%y</td> <td>年份，两位数字表示。</td></tr> <tr><td>%%</td> <td>% 字面值</td></tr> <tr><td>%x</td> <td>x，针对任何以上没有列出的情况。</td></tr></tbody></table> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DATE_FORMAT<span class="token punctuation">(</span><span class="token string">'1997-10-04 22:23:00'</span><span class="token punctuation">,</span> <span class="token string">'%W %M %Y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> DATE_FORMAT<span class="token punctuation">(</span><span class="token string">'1997-10-04 22:23:00'</span><span class="token punctuation">,</span> <span class="token string">'%W %M %Y'</span><span class="token punctuation">)</span>          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> Saturday October <span class="token number">1997</span>                                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DATE_FORMAT<span class="token punctuation">(</span><span class="token string">'1997-10-04 22:23:00'</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">'%H %k %I %r %T %S %w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> DATE_FORMAT<span class="token punctuation">(</span>'<span class="token number">1997</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">04</span> <span class="token number">22</span>:<span class="token number">23</span>:<span class="token number">00.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">22</span> <span class="token number">22</span> <span class="token number">10</span> <span class="token number">10</span>:<span class="token number">23</span>:<span class="token number">00</span> PM <span class="token number">22</span>:<span class="token number">23</span>:<span class="token number">00</span> <span class="token number">00</span> <span class="token number">6</span>                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="date-sub-date-interval-expr-unit">DATE_SUB(date,INTERVAL expr unit)</h3> <hr> <p>同 DATE_ADD() 函数相似。</p> <h3 id="day-date">DAY(date)</h3> <hr> <p>DAY() 是 DAYOFMONTH() 的别名。</p> <h3 id="dayname-date">DAYNAME(date)</h3> <hr> <p>返回 date 在星期中的名称。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DAYNAME<span class="token punctuation">(</span><span class="token string">'1998-02-05'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> DAYNAME<span class="token punctuation">(</span><span class="token string">'1998-02-05'</span><span class="token punctuation">)</span>                                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> Thursday                                                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="dayofmonth-date">DAYOFMONTH(date)</h3> <hr> <p>返回 date 是当月的第几天，范围为 0 到 31。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DAYOFMONTH<span class="token punctuation">(</span><span class="token string">'1998-02-03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> DAYOFMONTH<span class="token punctuation">(</span><span class="token string">'1998-02-03'</span><span class="token punctuation">)</span>                                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">3</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="dayofweek-date">DAYOFWEEK(date)</h3> <hr> <p>返回 date 是其所在星期的第几天(1 = Sunday, 2 = Monday,.., 7 = Saturday)，这里一星期中日期的名称与数字的对应关系符合 ODBC 标准。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DAYOFWEEK<span class="token punctuation">(</span><span class="token string">'1998-02-03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span>DAYOFWEEK<span class="token punctuation">(</span><span class="token string">'1998-02-03'</span><span class="token punctuation">)</span>                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">3</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="dayofyear-date">DAYOFYEAR(date)</h3> <hr> <p>返回 date 是当年的第几天，范围为 1 到 366。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DAYOFYEAR<span class="token punctuation">(</span><span class="token string">'1998-02-03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> DAYOFYEAR<span class="token punctuation">(</span><span class="token string">'1998-02-03'</span><span class="token punctuation">)</span>                                 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">34</span>                                                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="extract-unit-from-date">EXTRACT(unit FROM date)</h3> <hr> <p>EXTRACT() 与 DATE_ADD() 和 DATE_SUB() 使用相同的表示单位的占位符，其作用是提取日期值中相应的组成部分，而不是进行日期运算。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> EXTRACT<span class="token punctuation">(</span><span class="token keyword">YEAR</span> <span class="token keyword">FROM</span> <span class="token string">'1999-07-02'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> EXTRACT<span class="token punctuation">(</span><span class="token keyword">YEAR</span> <span class="token keyword">FROM</span> <span class="token string">'1999-07-02'</span><span class="token punctuation">)</span>                         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">1999</span>                                                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> EXTRACT<span class="token punctuation">(</span>YEAR_MONTH <span class="token keyword">FROM</span> <span class="token string">'1999-07-02 01:02:03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> EXTRACT<span class="token punctuation">(</span>YEAR_MONTH <span class="token keyword">FROM</span> <span class="token string">'1999-07-02 01:02:03'</span><span class="token punctuation">)</span>          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">199907</span>                                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="from-days-n">FROM_DAYS(N)</h3> <hr> <p>给出天数 N，返回 DATE 值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> FROM_DAYS<span class="token punctuation">(</span><span class="token number">729669</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> FROM_DAYS<span class="token punctuation">(</span><span class="token number">729669</span><span class="token punctuation">)</span>                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">1997</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">07</span>                                              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><p>在使用 FROM_DAYS() 处理比较老的日期的时候应当特别小心，该函数不适用于格里高利历诞生（1582）之前的日期。</p> <h3 id="from-unixtime-unix-timestamp-from-unixtime-unix-timestamp-format">FROM_UNIXTIME(unix_timestamp), FROM_UNIXTIME(unix_timestamp,format)</h3> <hr> <p>返回 UNIX 时间戳对应的日期值，根据函数所处的上下文环境不同，返回值得格式也不同，字符串上下文返回格式为 'YYYY-MM-DD HH:MM:SS'，数值型上下文返回格式则为 YYYYMMDDHHMMSS。返回值的时区为系统当前时区。UNIX 时间戳是一种系统内部时间表示，例如 UNIX_TIMESTAMP() 的返回值。</p> <p>如果给定格式的话，返回结果将会根据格式字符串进行格式化，其规则同 DATE_FORMAT() 函数。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> FROM_UNIXTIME<span class="token punctuation">(</span><span class="token number">875996580</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> FROM_UNIXTIME<span class="token punctuation">(</span><span class="token number">875996580</span><span class="token punctuation">)</span>                                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">1997</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">04</span> <span class="token number">22</span>:<span class="token number">23</span>:<span class="token number">00</span>                                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="hour-time">HOUR(time)</h3> <hr> <p>返回时间值的小时部分。对于一天中的时间来说，返回值的范围为 0 到 23。不过，TIME 类型的值可以大得多，所以 HOUR 函数可以返回比 23 大的值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">HOUR</span><span class="token punctuation">(</span><span class="token string">'10:05:03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">HOUR</span><span class="token punctuation">(</span><span class="token string">'10:05:03'</span><span class="token punctuation">)</span>                                        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">10</span>                                                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="last-day-date">LAST_DAY(date)</h3> <hr> <p>返回 date 或者 datetime 值所在月份的最后一天。如果参数无效的话，返回　NULL。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> LAST_DAY<span class="token punctuation">(</span><span class="token string">'2003-02-05'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> LAST_DAY<span class="token punctuation">(</span><span class="token string">'2003-02-05'</span><span class="token punctuation">)</span>                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2003</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">28</span>                                              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="localtime-and-localtime">LOCALTIME and LOCALTIME()</h3> <hr> <p>LOCALTIME 和 LOCALTIME() 是 NOW() 的别名。</p> <h3 id="localtimestamp-and-localtimestamp">LOCALTIMESTAMP and LOCALTIMESTAMP()</h3> <hr> <p>LOCALTIMESTAMP 和 LOCALTIMESTAMP() 是 NOW() 的别名。</p> <h3 id="makedate-year-dayofyear">MAKEDATE(year,dayofyear)</h3> <hr> <p>给定年份和（某天在一年中）的天数，返回对应的日期值。天数必须大于 0，否则返回值为 NULL。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MAKEDATE<span class="token punctuation">(</span><span class="token number">2001</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MAKEDATE<span class="token punctuation">(</span><span class="token number">2001</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> MAKEDATE<span class="token punctuation">(</span><span class="token number">2001</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MAKEDATE<span class="token punctuation">(</span><span class="token number">2001</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span>                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token string">'2001-01-31'</span><span class="token punctuation">,</span> <span class="token string">'2001-02-01'</span>                              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="maketime-hour-minute-second">MAKETIME(hour,minute,second)</h3> <hr> <p>根据参数给出的时、分、秒，返回对应的时间值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MAKETIME<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> MAKETIME<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span>                                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token string">'12:15:30'</span>                                              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="microsecond-expr">MICROSECOND(expr)</h3> <hr> <p>根据 time 或者 datetime 表达式 expr，返回微秒数，结果在 0 到 999999 之间。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MICROSECOND<span class="token punctuation">(</span><span class="token string">'12:00:00.123456'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> MICROSECOND<span class="token punctuation">(</span><span class="token string">'12:00:00.123456'</span><span class="token punctuation">)</span>                          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">123456</span>                                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="minute-time">MINUTE(time)</h3> <hr> <p>返回时间型值中的分钟部分，范围为 0 到 59。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">MINUTE</span><span class="token punctuation">(</span><span class="token string">'98-02-03 10:05:03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">MINUTE</span><span class="token punctuation">(</span><span class="token string">'98-02-03 10:05:03'</span><span class="token punctuation">)</span>                             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">5</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="month-date">MONTH(date)</h3> <hr> <p>返回日期型值中的月份，范围为 0 到 12。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span><span class="token string">'1998-02-03'</span><span class="token punctuation">)</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span><span class="token string">'1998-02-03'</span><span class="token punctuation">)</span>                                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="monthname-date">MONTHNAME(date)</h3> <hr> <p>返回日期型值所处月份的全名。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MONTHNAME<span class="token punctuation">(</span><span class="token string">'1998-02-05'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> MONTHNAME<span class="token punctuation">(</span><span class="token string">'1998-02-05'</span><span class="token punctuation">)</span>                                 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> February                                                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="now">NOW()</h3> <hr> <p>返回当前的日期和时间，结果的格式为 'YYYY-MM-DD HH:MM:SS' 或者 YYYYMMDDHHMMSS，如果函数上下文环境为字符型，则返回前者，否则如果函数处于数值型的上下文环境，则返回后者。返回值的时区为系统当前时区。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                                                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">1997</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">15</span> <span class="token number">23</span>:<span class="token number">50</span>:<span class="token number">26</span>                                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="period-add-p-n">PERIOD_ADD(P,N)</h3> <hr> <p>在时间 P（格式为 YYMM 或者 YYYYMM）上加上 N 个月，结果格式为 YYYYMM。注意，时间参数 P 并不是日期型值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> PERIOD_ADD<span class="token punctuation">(</span><span class="token number">9801</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> PERIOD_ADD<span class="token punctuation">(</span><span class="token number">9801</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>                                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">199803</span>                                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="period-diff-p1-p2">PERIOD_DIFF(P1,P2)</h3> <hr> <p>返回时间 P1 和 P2 之间相差的月份。 P1 和 P2 的格式应为 YYMM 或者 YYYYMM。注意I，P1 和 P2 不是日期型值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> PERIOD_DIFF<span class="token punctuation">(</span><span class="token number">9802</span><span class="token punctuation">,</span><span class="token number">199703</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> PERIOD_DIFF<span class="token punctuation">(</span><span class="token number">9802</span><span class="token punctuation">,</span><span class="token number">199703</span><span class="token punctuation">)</span>                                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">11</span>                                                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="quarter-date">QUARTER(date)</h3> <hr> <p>返回日期型值 date 所处的季度值，范围为 1 到 4。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> QUARTER<span class="token punctuation">(</span><span class="token string">'98-04-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> QUARTER<span class="token punctuation">(</span><span class="token string">'98-04-01'</span><span class="token punctuation">)</span>                                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="second-time">SECOND(time)</h3> <hr> <p>返回时间型值中秒的部分，范围为 0 到 59。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">SECOND</span><span class="token punctuation">(</span><span class="token string">'10:05:03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">SECOND</span><span class="token punctuation">(</span><span class="token string">'10:05:03'</span><span class="token punctuation">)</span>                                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">3</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="sec-to-time-seconds">SEC_TO_TIME(seconds)</h3> <hr> <p>将参数中的秒数转换为时分秒的格式 'HH:MM:SS' 或者 HHMMSS，如果函数所处的上下文为字符串型，则返回前者，否则如果上下文环境为数值型，则返回后者。</p> <h3 id="str-to-date-str-format">STR_TO_DATE(str,format)</h3> <hr> <p>这是 DATE_FORMATE() 函数的逆函数，其参数为表示时间和日期的字符串 str 和一个格式字符串 format。如果格式字符串中既有日期又有时间，则 STR_TO_DATE() 返回 DATETIME() 型的值，否则返回日期型（DATE）或者时间型（TIME）的值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'04/31/2004'</span><span class="token punctuation">,</span> <span class="token string">'%m/%d/%Y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'04/31/2004'</span><span class="token punctuation">,</span> <span class="token string">'%m/%d/%Y'</span><span class="token punctuation">)</span>                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2004</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">31</span>                                              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="subdate-date-interval-expr-unit-and-subdate-expr-days">SUBDATE(date,INTERVAL expr unit) and SUBDATE(expr,days)</h3> <hr> <p>当第二个参数为 INTERVAL 形式时，SUBDATE() 就是 DATE_SUB() 的别名。INTERVAL 参数中单位的信息，请见有关 DATE_ADD() 的讨论。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DATE_SUB<span class="token punctuation">(</span><span class="token string">'1998-01-02'</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">31</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> DATE_SUB<span class="token punctuation">(</span><span class="token string">'1998-01-02'</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">31</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span>                 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">1997</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">02</span>                                              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> SUBDATE<span class="token punctuation">(</span><span class="token string">'1998-01-02'</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">31</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> SUBDATE<span class="token punctuation">(</span><span class="token string">'1998-01-02'</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">31</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span>                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">1997</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">02</span>                                              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="subtime-expr1-expr2">SUBTIME(expr1,expr2)</h3> <hr> <p>SUBTIME() 返回 expr1-expr2，结果的格式与 expr1 相同。expr1 是一个时间型（time）或者 datetime 型的表达式，expr2 是时间型值。</p> <h3 id="sysdate">SYSDATE()</h3> <hr> <p>返回当前的日期和时间，格式为 'YYYY-MM-DD HH:MM:SS' 或 YYYYMMDDHHMMSS，如果函数所处的上下文环境为字符串，则返回前者，否则如果上下文环境为数值型，则返回后者。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> SYSDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> SYSDATE<span class="token punctuation">(</span><span class="token punctuation">)</span>                                               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2006</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">12</span> <span class="token number">13</span>:<span class="token number">47</span>:<span class="token number">44</span>                                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="time-expr">TIME(expr)</h3> <hr> <p>提取时间型或者 datetime 型表达式 expr 中的时间部分，返回结果为字符串。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">TIME</span><span class="token punctuation">(</span><span class="token string">'2003-12-31 01:02:03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">TIME</span><span class="token punctuation">(</span><span class="token string">'2003-12-31 01:02:03'</span><span class="token punctuation">)</span>                             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">01</span>:<span class="token number">02</span>:<span class="token number">03</span>                                                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="timediff-expr1-expr2">TIMEDIFF(expr1,expr2)</h3> <hr> <p>TIMEDIFF() 返回 expr1-expr2，结果为时间型值。expr1 和 expr2 可以为时间型或者 datetime 型表达式，不过二者必须为相同类型。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> TIMEDIFF<span class="token punctuation">(</span><span class="token string">'1997-12-31 23:59:59.000001'</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">'1997-12-30 01:01:01.000002'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> TIMEDIFF<span class="token punctuation">(</span><span class="token string">'1997-12-31 23:59:59.000001'</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span>  <span class="token number">46</span>:<span class="token number">58</span>:<span class="token number">57.999999</span>                                        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="timestamp-expr-timestamp-expr1-expr2">TIMESTAMP(expr), TIMESTAMP(expr1,expr2)</h3> <hr> <p>只有一个参数的时候，该函数由日期型或者 datetime 型表达式返回一个 datetime 型值。有两个参数的时候，该函数将 expr2 加到日期型或 datetime 型值 expr1 上，并返回 datetime 型的结果。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">(</span><span class="token string">'2003-12-31'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">(</span><span class="token string">'2003-12-31'</span><span class="token punctuation">)</span>                                 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2003</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span>                                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="timestampadd-unit-interval-datetime-expr">TIMESTAMPADD(unit,interval,datetime_expr)</h3> <hr> <p>将整数型的表达式 interval 加到日期型或者 datetime 型表达式 datetime_expr 上。单位由 unit 参数给出，其取值应为以下几种中的一种：FRAC_SECOND、SECOND、MINUTE、HOUR、DAY、WEEK、MONTH、QUARTER 或者 YEAR。</p> <p>单位 unit 可以为上述关键字中的一个，也可以添加一个 SQL<em>TSI</em> 前缀，例如 DAY 和 SQL_TSI_DAY 都是合法的。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> TIMESTAMPADD<span class="token punctuation">(</span><span class="token keyword">MINUTE</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2003-01-02'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> TIMESTAMPADD<span class="token punctuation">(</span><span class="token keyword">MINUTE</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2003-01-02'</span><span class="token punctuation">)</span>                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2003</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">00</span>:<span class="token number">01</span>:<span class="token number">00</span>                                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="timestampdiff-unit-datetime-expr1-datetime-expr2">TIMESTAMPDIFF(unit,datetime_expr1,datetime_expr2)</h3> <hr> <p>返回日期型或者 datetime 型表达式 datetime_expr1 和 datetime_expr2 的差。结果的单位由 unit 参数给出，unit 的取值规定同 TIMESTAMPADD() 函数。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> TIMESTAMPDIFF<span class="token punctuation">(</span><span class="token keyword">MONTH</span><span class="token punctuation">,</span><span class="token string">'2003-02-01'</span><span class="token punctuation">,</span><span class="token string">'2003-05-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> TIMESTAMPDIFF<span class="token punctuation">(</span><span class="token keyword">MONTH</span><span class="token punctuation">,</span><span class="token string">'2003-02-01'</span><span class="token punctuation">,</span><span class="token string">'2003-05-01'</span><span class="token punctuation">)</span>          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">3</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="time-format-time-format">TIME_FORMAT(time,format)</h3> <hr> <p>该函数使用起来类似 DATE_FORMAT() 函数，但是格式字符串 format 中只能有与小时、分钟和秒有关的那些占位符。</p> <p>如果时间型值的小时部分大于 23，则 %H 和 %k 格式占位符将会产生一个大于通常的 0-23 的值，其他与小时有关的占位符则会返回小时值除以 12 后的余数（modulo 12）。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> TIME_FORMAT<span class="token punctuation">(</span><span class="token string">'100:00:00'</span><span class="token punctuation">,</span> <span class="token string">'%H %k %h %I %l'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> TIME_FORMAT<span class="token punctuation">(</span><span class="token string">'100:00:00'</span><span class="token punctuation">,</span> <span class="token string">'%H %k %h %I %l'</span><span class="token punctuation">)</span>              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">100</span> <span class="token number">100</span> <span class="token number">04</span> <span class="token number">04</span> <span class="token number">4</span>                                         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="time-to-sec-time">TIME_TO_SEC(time)</h3> <hr> <p>将时间型值转换为秒。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> TIME_TO_SEC<span class="token punctuation">(</span><span class="token string">'22:23:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> TIME_TO_SEC<span class="token punctuation">(</span><span class="token string">'22:23:00'</span><span class="token punctuation">)</span>                                 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">80580</span>                                                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>、
</code></pre></div><h3 id="to-days-date">TO_DAYS(date)</h3> <hr> <p>给定日期型值 date，返回天数（自公元 0 年以来的天数）。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> TO_DAYS<span class="token punctuation">(</span><span class="token number">950501</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> TO_DAYS<span class="token punctuation">(</span><span class="token number">950501</span><span class="token punctuation">)</span>                                         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">728779</span>                                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="unix-timestamp-unix-timestamp-date">UNIX_TIMESTAMP(), UNIX_TIMESTAMP(date)</h3> <hr> <p>不带任何参数时，该函数返回一个 unsigned integer 型的 UNIX 时间戳（自 '1970-01-01 00:00:00' UTC 以来的秒数）。如果有一个参数 date 的话，该函数返回自 '1970-01-01 00:00:00' UTC 至 date 的秒数。date 可以是日期型的字符串、DATETIME 型的字符串、时间戳或者 YYMMDD 或 YYYYMMDD 格式的数字。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span>                                        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">882226357</span>                                               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'1997-10-04 22:23:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'1997-10-04 22:23:00'</span><span class="token punctuation">)</span>                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">875996580</span>                                               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="utc-date-utc-date">UTC_DATE, UTC_DATE()</h3> <hr> <p>返回当前 UTC 日期，格式为 'YYYY-MM-DD' 或者 YYYYMMDD，如果函数所处的上下文环境为字符串，则返回前者，否则如果上下文环境为数值型的，则返回后者。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> UTC_DATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> UTC_DATE<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> UTC_DATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> UTC_DATE<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0</span>                              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2003</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">20030814</span>                                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="utc-time-utc-time">UTC_TIME, UTC_TIME()</h3> <hr> <p>返回当前 UTC 时间，格式为 'HH:MM:SS' 或者 HHMMSS，如果函数所处的上下文环境为字符串，则返回前者，否则如果上下文环境为数值型的，则返回后者。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> UTC_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> UTC_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> UTC_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> UTC_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0</span>                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2003</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">14</span> <span class="token number">18</span>:<span class="token number">08</span>:<span class="token number">04</span><span class="token punctuation">,</span> <span class="token number">20030814180804</span>                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="week-date-mode">WEEK(date[,mode])</h3> <hr> <p>该函数将返回 date 所在的周是当年的第几周。两个参数的 WEEK() 函数的使你能够指明一周起始于周日还是周一，以及返回值的范围应该是 0 到 53，还是 1 到 53。如果 mode 参数被忽略，则将使用 default_week_format 系统变量。</p> <table><thead><tr><th>Mode</th> <th>一周的第一天</th> <th>范围</th> <th>周 1 是第一周</th></tr></thead> <tbody><tr><td>0</td> <td>Sunday</td> <td>0-53</td> <td>该年包括一个星期天</td></tr> <tr><td>1</td> <td>Monday</td> <td>0-53</td> <td>该年包含超过 3 天</td></tr> <tr><td>2</td> <td>Sunday</td> <td>1-53</td> <td>该年包括一个星期天</td></tr> <tr><td>3</td> <td>Monday</td> <td>1-53</td> <td>该年包含超过 3 天</td></tr> <tr><td>4</td> <td>Sunday</td> <td>0-53</td> <td>该年包含超过 3 天</td></tr> <tr><td>5</td> <td>Monday</td> <td>0-53</td> <td>该年包括一个星期一</td></tr> <tr><td>6</td> <td>Sunday</td> <td>1-53</td> <td>该年包含超过 3 天</td></tr> <tr><td>7</td> <td>Monday</td> <td>1-53</td> <td>该年包括一个星期一</td></tr></tbody></table> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> WEEK<span class="token punctuation">(</span><span class="token string">'1998-02-20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> WEEK<span class="token punctuation">(</span><span class="token string">'1998-02-20'</span><span class="token punctuation">)</span>                                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">7</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="weekday-date">WEEKDAY(date)</h3> <hr> <p>返回 date 是其所在星期的第几天 (0 = Monday, 1 = Tuesday, . 6 = Sunday)。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> WEEKDAY<span class="token punctuation">(</span><span class="token string">'1998-02-03 22:23:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> WEEKDAY<span class="token punctuation">(</span><span class="token string">'1998-02-03 22:23:00'</span><span class="token punctuation">)</span>                          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">1</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="weekofyear-date">WEEKOFYEAR(date)</h3> <hr> <p>返回 date 所在的周是当年的第几周，范围从 1 到 53. WEEKOFYEAR() 是一个兼容性函数，其功能同 WEEK(date, 3)相同。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> WEEKOFYEAR<span class="token punctuation">(</span><span class="token string">'1998-02-20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> WEEKOFYEAR<span class="token punctuation">(</span><span class="token string">'1998-02-20'</span><span class="token punctuation">)</span>                                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">8</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="year-date">YEAR(date)</h3> <hr> <p>返回 date 的年份部分，范围为 1000 到 9999，对于日期 0 则返回 0。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token string">'98-02-03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token string">'98-02-03'</span><span class="token punctuation">)</span>                                        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">1998</span>                                                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="yearweek-date-yearweek-date-mode">YEARWEEK(date), YEARWEEK(date,mode)</h3> <hr> <p>返回 date 所在的年份和周数。mode 参数意义与 WEEK() 函数的完全一样。对于一年中的第一周和最后一周来说，结果中的年份可能会和 date 参数中的年份不同。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> YEARWEEK<span class="token punctuation">(</span><span class="token string">'1987-01-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token string">'98-02-03'</span><span class="token punctuation">)</span>YEARWEEK<span class="token punctuation">(</span><span class="token string">'1987-01-01'</span><span class="token punctuation">)</span>                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">198653</span>                                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><blockquote><p><strong>注意</strong>，这里的周数同 WEEK() 返回的不同，因为 WEEK() 函数的返回值在给定年份的的上下文环境中得出。</p></blockquote> <h3 id="sql-field-函数">SQL FIELD()函数</h3> <hr> <p>SQL FIELD()函数实例代码教程</p> <p>FIELD()函数返回的索引（从1开始的位置）的str在str1，str2，str3，...列表中。如果str没有找到，则返回0。</p> <p>就是用第一个参数str，跟后面的N个字符串参数中寻找，如果寻找到一模一样的字符串，则返回其索引位置</p> <h3 id="field-str-str1-str2-str3">FIELD(str,str1,str2,str3,...)</h3> <hr> <p>返回的索引（从1开始的位置）的str在str1，str2，str3，...列表中。如果str没有找到，则返回0。</p> <h5 id="例子">例子</h5> <p>在第2个位置找到了字符串“ej”</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> FIELD<span class="token punctuation">(</span><span class="token string">'ej'</span><span class="token punctuation">,</span> <span class="token string">'Hej'</span><span class="token punctuation">,</span> <span class="token string">'ej'</span><span class="token punctuation">,</span> <span class="token string">'Heja'</span><span class="token punctuation">,</span> <span class="token string">'hej'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> FIELD<span class="token punctuation">(</span><span class="token string">'ej'</span><span class="token punctuation">,</span> <span class="token string">'Hej'</span><span class="token punctuation">,</span> <span class="token string">'ej'</span><span class="token punctuation">,</span> <span class="token string">'Heja'</span><span class="token punctuation">,</span> <span class="token string">'hej'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">)</span>          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2</span>                                                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span> 
</code></pre></div><h3 id="sql-group-by-语句">SQL GROUP BY 语句</h3> <hr> <p>Aggregate 函数常常需要添加 GROUP BY 语句。</p> <p>GROUP BY语句通常与集合函数（COUNT，MAX，MIN，SUM，AVG）一起使用，以按一个或多个列对结果集进行分组。</p> <h3 id="group-by-语句">GROUP BY 语句</h3> <hr> <p>GROUP BY 语句用于结合 Aggregate 函数，根据一个或多个列对结果集进行分组。</p> <h5 id="sql-group-by-语法">SQL GROUP BY 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-having-子句-2">SQL HAVING 子句</h3> <hr> <p>在 SQL 中增加 HAVING 子句原因是，WHERE 关键字无法与 Aggregate 函数一起使用。</p> <p>HAVING子句已添加到SQL中，因为WHERE关键字不能用于聚合函数。</p> <h5 id="sql-having-语法">SQL HAVING 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">HAVING</span> condition
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="sql-ucase-函数">SQL UCASE() 函数</h3> <hr> <p>UCASE() 函数把字段的值转换为大写。</p> <h5 id="sql-ucase-语法">SQL UCASE() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">UCASE</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>      
</code></pre></div><h3 id="sql-lcase-函数">SQL LCASE() 函数</h3> <hr> <p>LCASE() 函数把字段的值转换为小写。</p> <h5 id="sql-lcase-语法">SQL LCASE() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LCASE</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>     
</code></pre></div><p>​    SQL MID() 函数</p> <hr> <p>MID() 函数用于从文本字段中提取字符。</p> <h5 id="sql-mid-语法">SQL MID() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MID</span><span class="token punctuation">(</span>column_name<span class="token punctuation">,</span><span class="token keyword">start</span><span class="token punctuation">[</span><span class="token punctuation">,</span>length<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>       
</code></pre></div><table><thead><tr><th style="text-align:left">参数</th> <th style="text-align:left">描述</th></tr></thead> <tbody><tr><td style="text-align:left">column_name</td> <td style="text-align:left">必需。要提取字符的字段。</td></tr> <tr><td style="text-align:left">start</td> <td style="text-align:left">必需。规定开始位置（起始值是 1）。</td></tr> <tr><td style="text-align:left">length</td> <td style="text-align:left">可选。要返回的字符数。如果省略，则 MID() 函数返回剩余文本。</td></tr></tbody></table> <h3 id="sql-round-函数">SQL ROUND() 函数</h3> <hr> <p>ROUND() 函数用于把数值字段舍入为指定的小数位数。</p> <h5 id="sql-round-语法">SQL ROUND() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>column_name<span class="token punctuation">,</span>decimals<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>        
</code></pre></div><table><thead><tr><th style="text-align:left">参数</th> <th style="text-align:left">描述</th></tr></thead> <tbody><tr><td style="text-align:left">column_name</td> <td style="text-align:left">必需。要舍入的字段。</td></tr> <tr><td style="text-align:left">decimals</td> <td style="text-align:left">必需。规定要返回的小数位数。</td></tr></tbody></table> <h3 id="sql-now-函数">SQL NOW() 函数</h3> <hr> <p>NOW() 函数返回当前系统的日期和时间。</p> <h5 id="sql-now-语法">SQL NOW() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>        
</code></pre></div><h3 id="sql-format-函数">SQL FORMAT() 函数</h3> <hr> <p>FORMAT() 函数用于对字段的显示进行格式化。</p> <h5 id="sql-format-语法">SQL FORMAT() 语法</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">FORMAT</span><span class="token punctuation">(</span>column_name<span class="token punctuation">,</span>format<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>        
</code></pre></div><table><thead><tr><th style="text-align:left">参数</th> <th style="text-align:left">描述</th></tr></thead> <tbody><tr><td style="text-align:left">column_name</td> <td style="text-align:left">必需。要格式化的字段。</td></tr> <tr><td style="text-align:left">format</td> <td style="text-align:left">必需。规定格式。</td></tr></tbody></table> <h3 id="sql-sqrt-函数">SQL SQRT 函数</h3> <hr> <p><strong>SQRT</strong> 函数用于计算得出任何数值的平方根。你可以像下面这样使用 SELECT 语句计算任何数值的平方根：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span>  <span class="token keyword">select</span> SQRT<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">----------+</span>
    <span class="token operator">|</span> SQRT<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">----------+</span>
    <span class="token operator">|</span> <span class="token number">4.000000</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">----------+</span>
    <span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><p>你在这里看到的是浮点数，因为 SQL 以浮点数类型来进行平方根的计算。</p> <p>你还可以使用 SQRT 函数来计算表中记录的平方根。要获得对 <strong>SQRT</strong> 函数更深入的了解，请考虑 <strong>employee_tbl</strong> 表，表中记录如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee_tbl<span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span> id   <span class="token operator">|</span> name <span class="token operator">|</span> work_date  <span class="token operator">|</span> daily_typing_pages <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> John <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">24</span> <span class="token operator">|</span>                <span class="token number">250</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> Ram  <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">27</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">170</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">100</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> Jill <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">300</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">350</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><p>现在，假设你想要获取每个记录中 daily_typing_pages 的平方根，那么你可以用如下命令来达到目的：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> SQRT<span class="token punctuation">(</span>daily_typing_pages<span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">FROM</span> employee_tbl<span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">------+--------------------------+</span>
    <span class="token operator">|</span> name <span class="token operator">|</span> SQRT<span class="token punctuation">(</span>daily_typing_pages<span class="token punctuation">)</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+--------------------------+</span>
    <span class="token operator">|</span> John <span class="token operator">|</span>                <span class="token number">15.811388</span> <span class="token operator">|</span>
    <span class="token operator">|</span> Ram  <span class="token operator">|</span>                <span class="token number">14.832397</span> <span class="token operator">|</span>
    <span class="token operator">|</span> Jack <span class="token operator">|</span>                <span class="token number">13.038405</span> <span class="token operator">|</span>
    <span class="token operator">|</span> Jack <span class="token operator">|</span>                <span class="token number">10.000000</span> <span class="token operator">|</span>
    <span class="token operator">|</span> Jill <span class="token operator">|</span>                <span class="token number">14.832397</span> <span class="token operator">|</span>
    <span class="token operator">|</span> Zara <span class="token operator">|</span>                <span class="token number">17.320508</span> <span class="token operator">|</span>
    <span class="token operator">|</span> Zara <span class="token operator">|</span>                <span class="token number">18.708287</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+--------------------------+</span>
    <span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="sql-rand-函数">SQL RAND 函数</h3> <hr> <p>SQL 有一个 <strong>RAND</strong> 函数，用于产生 0 至 1 之间的随机数：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span>  <span class="token keyword">SELECT</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">------------------+-----------------+------------------+</span>
    <span class="token operator">|</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span>          <span class="token operator">|</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span>         <span class="token operator">|</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span>          <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------------------+-----------------+------------------+</span>
    <span class="token operator">|</span> <span class="token number">0.45464584925645</span> <span class="token operator">|</span> <span class="token number">0.1824410643265</span> <span class="token operator">|</span> <span class="token number">0.54826780459682</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------------------+-----------------+------------------+</span>
    <span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><p>当以某个整数值作为参数来调用的时候，RAND() 会将该值作为随机数发生器的种子。对于每一个给定的种子，RAND() 函数都会产生一列可以复现的数字：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span>  <span class="token keyword">SELECT</span> RAND<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">------------------+------------------+------------------+</span>
    <span class="token operator">|</span> RAND<span class="token punctuation">(</span><span class="token number">1</span> <span class="token punctuation">)</span>         <span class="token operator">|</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span>          <span class="token operator">|</span> RAND<span class="token punctuation">(</span> <span class="token punctuation">)</span>          <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------------------+------------------+------------------+</span>
    <span class="token operator">|</span> <span class="token number">0.18109050223705</span> <span class="token operator">|</span> <span class="token number">0.75023211143001</span> <span class="token operator">|</span> <span class="token number">0.20788908117254</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------------------+------------------+------------------+</span>
    <span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><p>你可以使用 <strong>ORDER BY RAND()</strong> 来对一组记录进行随机化排列，如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee_tbl<span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span> id   <span class="token operator">|</span> name <span class="token operator">|</span> work_date  <span class="token operator">|</span> daily_typing_pages <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> John <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">24</span> <span class="token operator">|</span>                <span class="token number">250</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> Ram  <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">27</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">170</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">100</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> Jill <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">300</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">350</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><p>现在，试试下面的命令：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee_tbl <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span> id   <span class="token operator">|</span> name <span class="token operator">|</span> work_date  <span class="token operator">|</span> daily_typing_pages <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">300</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">100</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">170</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> Ram  <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">27</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> Jill <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">350</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> John <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">24</span> <span class="token operator">|</span>                <span class="token number">250</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

    <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee_tbl <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span> id   <span class="token operator">|</span> name <span class="token operator">|</span> work_date  <span class="token operator">|</span> daily_typing_pages <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">350</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> Ram  <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">27</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">100</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> John <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">24</span> <span class="token operator">|</span>                <span class="token number">250</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> Jill <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">170</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">300</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="sql-concat-函数">SQL CONCAT 函数</h3> <hr> <p><strong>CONCAT</strong> 函数用于将两个字符串连接为一个字符串，试一下下面这个例子：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">'FIRST '</span><span class="token punctuation">,</span> <span class="token string">'SECOND'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">----------------------------+</span>
    <span class="token operator">|</span> CONCAT<span class="token punctuation">(</span><span class="token string">'FIRST '</span><span class="token punctuation">,</span> <span class="token string">'SECOND'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">----------------------------+</span>
    <span class="token operator">|</span> <span class="token keyword">FIRST</span> <span class="token keyword">SECOND</span>               <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">----------------------------+</span>
    <span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><p>要对 <strong>CONCAT</strong> 函数有更为深入的了解，请考虑 <strong>employee_tbl</strong> 表，表中记录如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee_tbl<span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span> id   <span class="token operator">|</span> name <span class="token operator">|</span> work_date  <span class="token operator">|</span> daily_typing_pages <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> John <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">24</span> <span class="token operator">|</span>                <span class="token number">250</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> Ram  <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">27</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">170</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> Jack <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">100</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> Jill <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">220</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">300</span> <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> Zara <span class="token operator">|</span> <span class="token number">2007</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span>                <span class="token number">350</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">------+------+------------+--------------------+</span>
    <span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><p>现在，假设你想要将上表中所有的姓名（name）、id和工作日（work_date）连接在一起，那么可以通过如下的命令来达到目的：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>    <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> work_date<span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">FROM</span> employee_tbl<span class="token punctuation">;</span>
    <span class="token operator">+</span><span class="token comment">-----------------------------+</span>
    <span class="token operator">|</span> CONCAT<span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> work_date<span class="token punctuation">)</span> <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">-----------------------------+</span>
    <span class="token operator">|</span> <span class="token number">1</span>John2007<span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">24</span>             <span class="token operator">|</span>
    <span class="token operator">|</span> <span class="token number">2</span>Ram2007<span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">27</span>              <span class="token operator">|</span>
    <span class="token operator">|</span> <span class="token number">3</span>Jack2007<span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">06</span>             <span class="token operator">|</span>
    <span class="token operator">|</span> <span class="token number">3</span>Jack2007<span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span>             <span class="token operator">|</span>
    <span class="token operator">|</span> <span class="token number">4</span>Jill2007<span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">06</span>             <span class="token operator">|</span>
    <span class="token operator">|</span> <span class="token number">5</span>Zara2007<span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">06</span>             <span class="token operator">|</span>
    <span class="token operator">|</span> <span class="token number">5</span>Zara2007<span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">06</span>             <span class="token operator">|</span>
    <span class="token operator">+</span><span class="token comment">-----------------------------+</span>
    <span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><h3 id="sql-null-函数">SQL NULL 函数</h3> <hr> <h5 id="sql-isnull-、nvl-、ifnull-和-coalesce-函数">SQL ISNULL()、NVL()、IFNULL() 和 COALESCE() 函数</h5> <p>请看下面的 &quot;Products&quot; 表：</p> <table><thead><tr><th style="text-align:left">P_Id</th> <th style="text-align:left">ProductName</th> <th style="text-align:left">UnitPrice</th> <th style="text-align:left">UnitsInStock</th> <th style="text-align:left">UnitsOnOrder</th></tr></thead> <tbody><tr><td style="text-align:left">1</td> <td style="text-align:left">Jarlsberg</td> <td style="text-align:left">10.45</td> <td style="text-align:left">16</td> <td style="text-align:left">15</td></tr> <tr><td style="text-align:left">2</td> <td style="text-align:left">Mascarpone</td> <td style="text-align:left">32.56</td> <td style="text-align:left">23</td> <td style="text-align:left"></td></tr> <tr><td style="text-align:left">3</td> <td style="text-align:left">Gorgonzola</td> <td style="text-align:left">15.67</td> <td style="text-align:left">9</td> <td style="text-align:left">20</td></tr></tbody></table> <p>假如 &quot;UnitsOnOrder&quot; 是可选的，而且可以包含 NULL 值。</p> <p>我们使用下面的 SELECT 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span>UnitsOnOrder<span class="token punctuation">)</span>                
<span class="token keyword">FROM</span> Products        
</code></pre></div><p>在上面的实例中，如果有 &quot;UnitsOnOrder&quot; 值是 NULL，那么结果是 NULL。</p> <p>微软的 ISNULL() 函数用于规定如何处理 NULL 值。</p> <p>NVL()、IFNULL() 和 COALESCE() 函数也可以达到相同的结果。</p> <p>在这里，我们希望 NULL 值为 0。</p> <p>下面，如果 &quot;UnitsOnOrder&quot; 是 NULL，则不会影响计算，因为如果值是 NULL 则 ISNULL() 返回 0：</p> <h6 id="sql-server-ms-access"><strong>SQL Server / MS Access</strong></h6> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span>ISNULL<span class="token punctuation">(</span>UnitsOnOrder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                
<span class="token keyword">FROM</span> Products       
</code></pre></div><h6 id="oracle"><strong>Oracle</strong></h6> <p>Oracle 没有 ISNULL() 函数。不过，我们可以使用 NVL() 函数达到相同的结果：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span>NVL<span class="token punctuation">(</span>UnitsOnOrder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                
<span class="token keyword">FROM</span> Products        
</code></pre></div><h6 id="mysql"><strong>MySQL</strong></h6> <p>MySQL 也拥有类似 ISNULL() 的函数。不过它的工作方式与微软的 ISNULL() 函数有点不同。</p> <p>在 MySQL 中，我们可以使用 IFNULL() 函数，如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>UnitsOnOrder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                
<span class="token keyword">FROM</span> Products        
</code></pre></div><p>或者我们可以使用 COALESCE() 函数，如下所示：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span><span class="token keyword">COALESCE</span><span class="token punctuation">(</span>UnitsOnOrder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>               
<span class="token keyword">FROM</span> Products       
</code></pre></div><h3 id="sql-replace-字符串替换函数">SQL REPLACE()字符串替换函数</h3> <hr> <h5 id="实例-4">实例</h5> <p>把数据库表article中的所有title字段里的w3cschool字符串替换成hello。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">update</span> <span class="token punctuation">`</span>article<span class="token punctuation">`</span> <span class="token keyword">set</span> title<span class="token operator">=</span><span class="token keyword">replace</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span><span class="token string">'w3cschool'</span><span class="token punctuation">,</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="replace函数定义">replace函数定义</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">replace</span><span class="token punctuation">(</span>original<span class="token operator">-</span>string，search<span class="token operator">-</span>string，<span class="token keyword">replace</span><span class="token operator">-</span>string<span class="token punctuation">)</span>
</code></pre></div><h5 id="参数">参数</h5> <p>original-string： 被搜索的字符串。可为任意长度。
search-string： 要搜索并被 replace-string 替换的字符串。该字符串的长度不应超过 255 个字节。如果 search-string 是空字符串，则按原样返回原始字符串。
replace-string： 该字符串用于替换 search-string。可为任意长度。如果 replacement-string 是空字符串，则删除出现的所有 search-string。</p> <h5 id="说明">说明</h5> <p>用字符串表达式3替换字符串表达式1中出现的所有字符串表达式2的匹配项。返回新的字符串。 　如果有某个参数为 NULL，此函数返回 NULL。</p> <h3 id="sql-trim-函数去除字符串头尾空格">SQL TRIM()函数去除字符串头尾空格</h3> <hr> <p>SQL 中的 TRIM 函数是用来移除掉一个字串中的字头或字尾。最常见的用途是移除字首或字尾的空白。这个函数在不同的资料库中有不同的名称：</p> <ul><li>MySQL: TRIM( ), RTRIM( ), LTRIM( )</li> <li>Oracle: RTRIM( ), LTRIM( )</li> <li>SQL Server: RTRIM( ), LTRIM( )</li></ul> <p>各种 trim 函数的语法如下：</p> <ul><li><strong>TRIM ( [ [位置] [要移除的字串] FROM ] 字串)</strong>: [位置] 的可能值为 LEADING (起头), TRAILING (结尾), or BOTH (起头及结尾)。 这个函数将把 [要移除的字串] 从字串的起头、结尾，或是起头及结尾移除。如果我们没有列出 [要移除的字串] 是什么的话，那空白就会被移除。</li> <li><strong>LTRIM(字串)</strong>: 将所有字串起头的空白移除。</li> <li><strong>RTRIM(字串)</strong>: 将所有字串结尾的空白移除。</li></ul> <h5 id="例1-trim">例1 TRIM()</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> TRIM<span class="token punctuation">(</span><span class="token string">'   Sample   '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>结果:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token string">'Sample'</span>
</code></pre></div><h5 id="例2-ltrim">例2 LTRIM()</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LTRIM<span class="token punctuation">(</span><span class="token string">'   Sample   '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>结果:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token string">'Sample   '</span>
</code></pre></div><h5 id="例3-rtrim">例3 RTRIM()</h5> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> RTRIM<span class="token punctuation">(</span><span class="token string">'   Sample   '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>结果:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token string">'   Sample'</span>
</code></pre></div><h2 id="拓展">拓展</h2> <p><a href="https://www.w3cschool.cn/sql/sql-storage.html" target="_blank" rel="noopener noreferrer">详细实例全面解析SQL存储过程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.w3cschool.cn/sql/sql-sentence.html" target="_blank" rel="noopener noreferrer">详尽的SQL语句大全分类整理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h1 id="工业数据库">工业数据库</h1> <h2 id="oracle-2">Oracle</h2> <h2 id="mysql-2">Mysql</h2> <h2 id="sql-server">SQL Server</h2> <h2 id="redis">Redis</h2> <h2 id="mongodb">MongoDB</h2></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/articles/datascience/Music-Recommendation.html" class="prev">
          Music-Recommendation
        </a></span> <span class="next"><a href="/articles/datascience/DataWarehouse/IST722.html">
          IST-722
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.265cfc62.js" defer></script><script src="/assets/js/28.e5f55e62.js" defer></script>
  </body>
</html>
